<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="BorangF" pageWidth="595" pageHeight="842" whenNoDataType="AllSectionsNoDetail" columnWidth="535" leftMargin="30" rightMargin="30" topMargin="5" bottomMargin="20" uuid="b41665a8-7461-4c0d-b5d1-0891d6bf8859">
	<property name="ireport.zoom" value="1.5"/>
	<property name="ireport.x" value="0"/>
	<property name="ireport.y" value="16"/>
	<property name="ireport.scriptlethandling" value="0"/>
	<property name="ireport.encoding" value="UTF-8"/>
	<import value="net.sf.jasperreports.engine.*"/>
	<import value="java.util.*"/>
	<import value="net.sf.jasperreports.engine.data.*"/>
	<parameter name="idfail" class="java.lang.String"/>
	<parameter name="namaPegawai" class="java.lang.String"/>
	<parameter name="jawatan" class="java.lang.String"/>
	<parameter name="daerahMohon" class="java.lang.String"/>
	<parameter name="ReportDir" class="java.lang.String"/>
	<parameter name="namaPentadbir" class="java.lang.String"/>
	<parameter name="namaPentadbirBorangF" class="java.lang.String"/>
	<parameter name="NILAI_BERSIH_1" class="java.lang.String"/>
	<parameter name="NILAI_BERSIH_2" class="java.lang.String"/>
	<parameter name="flagLampiran" class="java.lang.Boolean">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<queryString>
		<![CDATA[SELECT UTAMA.*,
CASE
    WHEN LENGTH(UTAMA.NBARU_MATI) != 12 THEN  ''||RTRIM(UTAMA.NBARU_MATI)||''
    WHEN LENGTH(RTRIM(UTAMA.NBARU_MATI))=12 THEN SUBSTR(UTAMA.NBARU_MATI,1,6) || '-' || SUBSTR(UTAMA.NBARU_MATI,7,2) || '-' || SUBSTR(UTAMA.NBARU_MATI,9,4)
    ELSE ''
END
||
CASE WHEN UTAMA.NBARU_MATI IS NOT NULL THEN
CASE WHEN UTAMA.NLAMA_MATI IS NOT NULL AND UTAMA.NLAIN_MATI IS NOT NULL THEN ' (' || UTAMA.NLAMA_MATI || '/' || UTAMA.NLAIN_MATI || ')'
WHEN UTAMA.NLAMA_MATI IS NOT NULL AND UTAMA.NLAIN_MATI IS NULL THEN ' (' || UTAMA.NLAMA_MATI || ')'
WHEN UTAMA.NLAMA_MATI IS NULL AND UTAMA.NLAIN_MATI IS NOT NULL THEN ' (' || UTAMA.NLAIN_MATI || ')'
ELSE '' END
ELSE CASE WHEN UTAMA.NLAMA_MATI IS NOT NULL AND UTAMA.NLAIN_MATI IS NOT NULL THEN UTAMA.NLAMA_MATI || '/' || UTAMA.NLAIN_MATI
WHEN UTAMA.NLAMA_MATI IS NOT NULL AND UTAMA.NLAIN_MATI IS NULL THEN UTAMA.NLAMA_MATI
WHEN UTAMA.NLAMA_MATI IS NULL AND UTAMA.NLAIN_MATI IS NOT NULL THEN UTAMA.NLAIN_MATI
ELSE '' END
 END
AS KP_SIMATI,
CASE
    WHEN LENGTH(UTAMA.NBARU_MOHON) != 12 THEN  ''||RTRIM(UTAMA.NBARU_MOHON)||''
    WHEN LENGTH(RTRIM(UTAMA.NBARU_MOHON))=12 THEN SUBSTR(UTAMA.NBARU_MOHON,1,6) || '-' || SUBSTR(UTAMA.NBARU_MOHON,7,2) || '-' || SUBSTR(UTAMA.NBARU_MOHON,9,4)
    ELSE ''
END
||
CASE WHEN UTAMA.NBARU_MOHON IS NOT NULL THEN

CASE WHEN UTAMA.NLAMA_MOHON IS NOT NULL AND UTAMA.NLAIN_MOHON IS NOT NULL THEN ' (' || UTAMA.NLAMA_MOHON || '/' || UTAMA.NLAIN_MOHON || ')'
WHEN UTAMA.NLAMA_MOHON IS NOT NULL AND UTAMA.NLAIN_MOHON IS NULL THEN ' (' || UTAMA.NLAMA_MOHON || ')'
WHEN UTAMA.NLAMA_MOHON IS NULL AND UTAMA.NLAIN_MOHON IS NOT NULL THEN ' (' || UTAMA.NLAIN_MOHON || ')'
ELSE '' END
ELSE CASE WHEN UTAMA.NLAMA_MOHON IS NOT NULL AND UTAMA.NLAIN_MOHON IS NOT NULL THEN UTAMA.NLAMA_MOHON || '/' || UTAMA.NLAIN_MOHON
WHEN UTAMA.NLAMA_MOHON IS NOT NULL AND UTAMA.NLAIN_MOHON IS NULL THEN UTAMA.NLAMA_MOHON
WHEN UTAMA.NLAMA_MOHON IS NULL AND UTAMA.NLAIN_MOHON IS NOT NULL THEN UTAMA.NLAIN_MOHON
ELSE '' END
 END
AS KP_PEMOHON
FROM (
SELECT B.ID_FAIL,F.ID_PERMOHONAN,K.ID_PERBICARAAN,K.ID_KEPUTUSANPERMOHONAN,N.ID_PERINTAH, N.ID_HTA, N.ID_JENISPERINTAH, REPLACE(B.NO_FAIL,'&','&#38;') AS NO_FAIL, REPLACE(C.NAMA_DAERAH,'&','&#38;') AS DAERAH_MOHON, D.NAMA_NEGERI AS NEGERI_MOHON,
       TO_CHAR(A.TARIKH_MOHON,'yyyy') AS TAHUN, E.NAMA_SIMATI,E.NAMA_LAIN,
       E.NO_KP_BARU AS NBARU_MATI, E.NO_KP_LAMA AS NLAMA_MATI, E.NO_KP_LAIN AS NLAIN_MATI, H.NO_KP_BARU AS NBARU_MOHON, H.NO_KP_LAMA AS NLAMA_MOHON, H.NO_KP_LAIN AS NLAIN_MOHON,
        CASE
        WHEN E.ALAMAT_1 IS NULL AND E.ID_NEGERI <> 14 THEN '-'
        WHEN E.ALAMAT_1 IS NOT NULL AND E.ID_NEGERI <> 14 THEN Upper(REPLACE(e.ALAMAT_1,'&','&#38;')) || ', ' || Upper(REPLACE(e.ALAMAT_2,'&','&#38;')) || ', ' || Upper(REPLACE(e.ALAMAT_3,'&','&#38;'))||', ' ||REPLACE(e.poskod,'&','&#38;') || ' ' || REPLACE(REPLACE(UPPER(T.KETERANGAN),','),'&','&#38;') ||', '|| REPLACE(REPLACE(UPPER(G.NAMA_NEGERI),','),'&','&#38;')
        WHEN E.ALAMAT_2 IS NULL AND E.ALAMAT_3 IS NULL AND E.ID_NEGERI <> 14 THEN  REPLACE(UPPER(E.ALAMAT_1),',') || ', ' || REPLACE(REPLACE(UPPER(E.POSKOD),','),'&','&#38;') || ' ' || REPLACE(REPLACE(UPPER(T.KETERANGAN),','),'&','&#38;') ||', '|| REPLACE(REPLACE(UPPER(G.NAMA_NEGERI),','),'&','&#38;')
        WHEN E.ALAMAT_2 IS NULL AND E.ID_NEGERI <> 14 THEN REPLACE(UPPER(E.ALAMAT_1),',') ||', ' || REPLACE(REPLACE(UPPER(E.ALAMAT_3),','),'&','&#38;') || ', ' || REPLACE(REPLACE(UPPER(E.POSKOD),','),'&','&#38;') || ' ' ||REPLACE(REPLACE(UPPER(T.KETERANGAN),','),'&','&#38;') ||', '|| REPLACE(REPLACE(UPPER(G.NAMA_NEGERI),','),'&','&#38;')
        WHEN E.ALAMAT_3 IS NULL AND E.ID_NEGERI <> 14 THEN REPLACE(UPPER(E.ALAMAT_1),',') ||', ' || REPLACE(REPLACE(UPPER(E.ALAMAT_2),','),'&','&#38;') || ', ' || REPLACE(REPLACE(UPPER(E.POSKOD),','),'&','&#38;') || ' ' ||REPLACE(REPLACE(UPPER(T.KETERANGAN),','),'&','&#38;') ||', '|| REPLACE(REPLACE(UPPER(G.NAMA_NEGERI),','),'&','&#38;')
        WHEN E.ALAMAT_3 IS NOT NULL AND E.ID_NEGERI <> 14 THEN REPLACE(UPPER(E.ALAMAT_1),',')||', ' || REPLACE(REPLACE(UPPER(E.ALAMAT_2),','),'&','&#38;') || ', ' || REPLACE(REPLACE(UPPER(E.ALAMAT_3),','),'&','&#38;') || ', ' || REPLACE(REPLACE(UPPER(E.POSKOD),','),'&','&#38;') || ' ' ||REPLACE(REPLACE(UPPER(T.KETERANGAN),','),'&','&#38;') ||', '|| REPLACE(REPLACE(UPPER(G.NAMA_NEGERI),','),'&','&#38;')

        WHEN E.ALAMAT_1 IS NULL AND E.ID_NEGERI = 14 THEN '-'
        WHEN E.ALAMAT_1 IS NOT NULL AND E.ID_NEGERI = 14 THEN Upper(REPLACE(e.ALAMAT_1,'&','&#38;')) || ', ' || Upper(REPLACE(e.ALAMAT_2,'&','&#38;')) || ', ' || Upper(REPLACE(e.ALAMAT_3,'&','&#38;'))||', ' ||REPLACE(e.poskod,'&','&#38;') || ' ' || REPLACE(REPLACE(UPPER(T.KETERANGAN),','),'&','&#38;')
        WHEN E.ALAMAT_2 IS NULL AND E.ALAMAT_3 IS NULL AND D.ID_NEGERI = 14 THEN  REPLACE(UPPER(E.ALAMAT_1),',') || ', ' || REPLACE(REPLACE(UPPER(E.POSKOD),','),'&','&#38;') || ' ' || REPLACE(REPLACE(UPPER(T.KETERANGAN),','),'&','&#38;')
        WHEN E.ALAMAT_2 IS NULL AND E.ID_NEGERI = 14 THEN REPLACE(UPPER(E.ALAMAT_1),',') ||', ' || REPLACE(REPLACE(UPPER(E.ALAMAT_3),','),'&','&#38;') || ', ' || REPLACE(REPLACE(UPPER(E.POSKOD),','),'&','&#38;') || ' ' ||REPLACE(REPLACE(UPPER(T.KETERANGAN),','),'&','&#38;')
        WHEN E.ALAMAT_3 IS NULL AND E.ID_NEGERI = 14 THEN REPLACE(UPPER(E.ALAMAT_1),',') ||', ' || REPLACE(REPLACE(UPPER(E.ALAMAT_2),','),'&','&#38;') || ', ' || REPLACE(REPLACE(UPPER(E.POSKOD),','),'&','&#38;') || ' ' ||REPLACE(REPLACE(UPPER(T.KETERANGAN),','),'&','&#38;')
        WHEN E.ALAMAT_3 IS NOT NULL AND E.ID_NEGERI = 14 THEN REPLACE(UPPER(E.ALAMAT_1),',')||', ' || REPLACE(REPLACE(UPPER(E.ALAMAT_2),','),'&','&#38;') || ', ' || REPLACE(REPLACE(UPPER(E.ALAMAT_3),','),'&','&#38;') || ', ' || REPLACE(REPLACE(UPPER(E.POSKOD),','),'&','&#38;') || ' ' ||REPLACE(REPLACE(UPPER(T.KETERANGAN),','),'&','&#38;')

        ELSE '-'
       END AS ALAMAT_PENUH_SIMATI,

       TO_CHAR(E.TARIKH_MATI,'dd/mm/yyyy') AS TARIKH_MATI,
       REPLACE(E.NO_SIJIL_MATI,'&','&#38;') NO_SIJIL_MATI,
       H.NAMA_PEMOHON,H.NO_KP_BARU,
        CASE
        WHEN H.ALAMAT1_SURAT IS NULL THEN '-'
        WHEN H.ALAMAT2_SURAT IS NULL AND H.ALAMAT3_SURAT IS NULL THEN  REPLACE(REPLACE(UPPER(H.ALAMAT1_SURAT),','),'&','&#38;') || ', ' || REPLACE(REPLACE(UPPER(H.POSKOD_SURAT),','),'&','&#38;') ||' '||REPLACE(REPLACE(UPPER(I.KETERANGAN),','),'&','&#38;')|| ', ' || REPLACE(REPLACE(UPPER(J.NAMA_NEGERI),','),'&','&#38;')
        WHEN H.ALAMAT2_SURAT IS NULL THEN REPLACE(REPLACE(UPPER(H.ALAMAT1_SURAT),','),'&','&#38;') ||', ' || REPLACE(REPLACE(UPPER(H.ALAMAT3_SURAT),','),'&','&#38;') || REPLACE(REPLACE(UPPER(H.POSKOD_SURAT),','),'&','&#38;')||' '||REPLACE(REPLACE(UPPER(I.KETERANGAN),','),'&','&#38;') ||', '|| REPLACE(REPLACE(UPPER(J.NAMA_NEGERI),','),'&','&#38;')
        WHEN H.ALAMAT3_SURAT IS NULL THEN REPLACE(REPLACE(UPPER(H.ALAMAT1_SURAT),','),'&','&#38;') ||', ' || REPLACE(REPLACE(UPPER(H.ALAMAT2_SURAT),','),'&','&#38;') || ', ' || REPLACE(REPLACE(UPPER(H.POSKOD_SURAT),','),'&','&#38;')||' '||REPLACE(REPLACE(UPPER(I.KETERANGAN),','),'&','&#38;') ||', '|| REPLACE(REPLACE(UPPER(J.NAMA_NEGERI),','),'&','&#38;')
        WHEN H.ALAMAT3_SURAT IS NOT NULL THEN REPLACE(REPLACE(UPPER(H.ALAMAT1_SURAT),','),'&','&#38;')||', ' || REPLACE(REPLACE(UPPER(H.ALAMAT2_SURAT),','),'&','&#38;') || ', ' || REPLACE(REPLACE(UPPER(H.ALAMAT3_SURAT),','),'&','&#38;') || ', ' || REPLACE(REPLACE(UPPER(H.POSKOD_SURAT),','),'&','&#38;')||' '||REPLACE(REPLACE(UPPER(I.KETERANGAN),','),'&','&#38;') ||', '|| REPLACE(REPLACE(UPPER(J.NAMA_NEGERI),','),'&','&#38;')
        ELSE '-'
       END AS ALAMAT_PENUH_PEMOHON,

       TO_CHAR (S.TARIKH_PERINTAH,'dd/mm/yyyy') AS TARIKH_PERINTAH,
       TO_CHAR (S.TARIKH_PERINTAH,'dd') AS HARI_PERINTAH,
       CASE
        WHEN TO_CHAR(S.TARIKH_PERINTAH,'mm')='01' THEN 'Januari'
        WHEN TO_CHAR(S.TARIKH_PERINTAH,'mm')='02' THEN 'Februari'
        WHEN TO_CHAR(S.TARIKH_PERINTAH,'mm')='03' THEN 'Mac'
        WHEN TO_CHAR(S.TARIKH_PERINTAH,'mm')='04' THEN 'April'
        WHEN TO_CHAR(S.TARIKH_PERINTAH,'mm')='05' THEN 'Mei'
        WHEN TO_CHAR(S.TARIKH_PERINTAH,'mm')='06' THEN 'Jun'
        WHEN TO_CHAR(S.TARIKH_PERINTAH,'mm')='07' THEN 'Julai'
        WHEN TO_CHAR(S.TARIKH_PERINTAH,'mm')='08' THEN 'Ogos'
        WHEN TO_CHAR(S.TARIKH_PERINTAH,'mm')='09' THEN 'September'
        WHEN TO_CHAR(S.TARIKH_PERINTAH,'mm')='10' THEN 'Oktober'
        WHEN TO_CHAR(S.TARIKH_PERINTAH,'mm')='11' THEN 'November'
        WHEN TO_CHAR(S.TARIKH_PERINTAH,'mm')='12' THEN 'Disember'
      END AS BULAN_PERINTAH,
       TO_CHAR(S.TARIKH_PERINTAH,'yyyy') AS TAHUN_PERINTAH,
       CASE
                WHEN K.ALAMAT_BICARA1 IS NULL AND K.ID_NEGERIBICARA <> 14 THEN REPLACE(REPLACE(UPPER(trim(K.TEMPAT_BICARA)),','),'&','&#38;')
                WHEN K.ALAMAT_BICARA2 IS NULL AND K.ALAMAT_BICARA3 IS NULL AND K.ID_NEGERIBICARA <> 14 THEN REPLACE(REPLACE(UPPER(trim(K.TEMPAT_BICARA)),','),'&','&#38;') || ', ' || REPLACE(REPLACE(UPPER(trim(K.ALAMAT_BICARA1)),','),'&','&#38;') || ', ' || REPLACE(REPLACE(UPPER(trim(K.POSKOD)),','),'&','&#38;') || ' ' || REPLACE(REPLACE(UPPER(trim(K.BANDAR)),','),'&','&#38;') ||', '|| REPLACE(REPLACE(UPPER(trim(R.NAMA_NEGERI)),','),'&','&#38;')
                WHEN K.ALAMAT_BICARA2 IS NULL AND K.ID_NEGERIBICARA <> 14 THEN REPLACE(REPLACE(UPPER(trim(K.TEMPAT_BICARA)),','),'&','&#38;') || ', ' || REPLACE(REPLACE(UPPER(trim(K.ALAMAT_BICARA1)),','),'&','&#38;') ||', ' || REPLACE(REPLACE(UPPER(trim(K.ALAMAT_BICARA3)),','),'&','&#38;') || ', ' || REPLACE(REPLACE(UPPER(trim(K.POSKOD)),','),'&','&#38;') || ' ' ||REPLACE(REPLACE(UPPER(trim(K.BANDAR)),','),'&','&#38;') ||', '|| REPLACE(REPLACE(UPPER(trim(R.NAMA_NEGERI)),','),'&','&#38;')
                WHEN K.ALAMAT_BICARA3 IS NULL AND K.ID_NEGERIBICARA <> 14 THEN REPLACE(REPLACE(UPPER(trim(K.TEMPAT_BICARA)),','),'&','&#38;') || ', ' || REPLACE(REPLACE(UPPER(trim(K.ALAMAT_BICARA1)),','),'&','&#38;') ||', ' || REPLACE(REPLACE(UPPER(trim(K.ALAMAT_BICARA2)),','),'&','&#38;') || ', ' || REPLACE(REPLACE(UPPER(trim(K.POSKOD)),','),'&','&#38;') || ' ' ||REPLACE(REPLACE(UPPER(trim(K.BANDAR)),','),'&','&#38;') ||', '|| REPLACE(REPLACE(UPPER(trim(R.NAMA_NEGERI)),','),'&','&#38;')
                WHEN K.ALAMAT_BICARA3 IS NOT NULL AND K.ID_NEGERIBICARA <> 14 THEN REPLACE(REPLACE(UPPER(trim(K.TEMPAT_BICARA)),','),'&','&#38;') || ', ' || REPLACE(REPLACE(UPPER(trim(K.ALAMAT_BICARA1)),','),'&','&#38;')||', ' || REPLACE(REPLACE(UPPER(trim(K.ALAMAT_BICARA2)),','),'&','&#38;') || ', ' || REPLACE(REPLACE(UPPER(trim(K.ALAMAT_BICARA3)),','),'&','&#38;') || ', ' || REPLACE(REPLACE(UPPER(trim(K.POSKOD)),','),'&','&#38;') || ' ' || REPLACE(REPLACE(UPPER(trim(K.BANDAR)),','),'&','&#38;') ||', '|| REPLACE(REPLACE(UPPER(trim(R.NAMA_NEGERI)),','),'&','&#38;')

                WHEN K.ALAMAT_BICARA1 IS NULL AND K.ID_NEGERIBICARA = 14 THEN REPLACE(REPLACE(UPPER(trim(K.TEMPAT_BICARA)),','),'&','&#38;')
                WHEN K.ALAMAT_BICARA2 IS NULL AND K.ALAMAT_BICARA3 IS NULL AND K.ID_NEGERIBICARA = 14 THEN REPLACE(REPLACE(UPPER(trim(K.TEMPAT_BICARA)),','),'&','&#38;') || ', ' || REPLACE(REPLACE(UPPER(trim(K.ALAMAT_BICARA1)),','),'&','&#38;') || ', ' || REPLACE(REPLACE(UPPER(trim(K.POSKOD)),','),'&','&#38;') || ' ' || REPLACE(REPLACE(UPPER(trim(K.BANDAR)),','),'&','&#38;')
                WHEN K.ALAMAT_BICARA2 IS NULL AND K.ID_NEGERIBICARA = 14 THEN REPLACE(REPLACE(UPPER(trim(K.TEMPAT_BICARA)),','),'&','&#38;') || ', ' || REPLACE(REPLACE(UPPER(trim(K.ALAMAT_BICARA1)),','),'&','&#38;') ||', ' || REPLACE(REPLACE(UPPER(trim(K.ALAMAT_BICARA3)),','),'&','&#38;') || ', ' || REPLACE(REPLACE(UPPER(trim(K.POSKOD)),','),'&','&#38;') || ' ' ||REPLACE(REPLACE(UPPER(trim(K.BANDAR)),','),'&','&#38;')
                WHEN K.ALAMAT_BICARA3 IS NULL AND K.ID_NEGERIBICARA = 14 THEN REPLACE(REPLACE(UPPER(trim(K.TEMPAT_BICARA)),','),'&','&#38;') || ', ' || REPLACE(REPLACE(UPPER(trim(K.ALAMAT_BICARA1)),','),'&','&#38;') ||', ' || REPLACE(REPLACE(UPPER(trim(K.ALAMAT_BICARA2)),','),'&','&#38;') || ', ' || REPLACE(REPLACE(UPPER(trim(K.POSKOD)),','),'&','&#38;') || ' ' ||REPLACE(REPLACE(UPPER(trim(K.BANDAR)),','),'&','&#38;')
                WHEN K.ALAMAT_BICARA3 IS NOT NULL AND K.ID_NEGERIBICARA = 14 THEN REPLACE(REPLACE(UPPER(trim(K.TEMPAT_BICARA)),','),'&','&#38;') || ', ' || REPLACE(REPLACE(UPPER(trim(K.ALAMAT_BICARA1)),','),'&','&#38;')||', ' || REPLACE(REPLACE(UPPER(trim(K.ALAMAT_BICARA2)),','),'&','&#38;') || ', ' || REPLACE(REPLACE(UPPER(trim(K.ALAMAT_BICARA3)),','),'&','&#38;') || ', ' || REPLACE(REPLACE(UPPER(trim(K.POSKOD)),','),'&','&#38;')|| ' ' || REPLACE(REPLACE(UPPER(trim(K.BANDAR)),','),'&','&#38;')

                ELSE 'TIADA'
            END AS ALAMAT_PENUH_BICARA,
       TO_CHAR (K.TARIKH_BICARA,'dd/mm/yyyy') AS TARIKH_BICARA,
       TO_CHAR (K.TARIKH_BICARA,'dd') AS HARI_BICARA,
       CASE
        WHEN TO_CHAR(K.TARIKH_BICARA,'mm')='01' THEN 'Januari'
        WHEN TO_CHAR(K.TARIKH_BICARA,'mm')='02' THEN 'Februari'
        WHEN TO_CHAR(K.TARIKH_BICARA,'mm')='03' THEN 'Mac'
        WHEN TO_CHAR(K.TARIKH_BICARA,'mm')='04' THEN 'April'
        WHEN TO_CHAR(K.TARIKH_BICARA,'mm')='05' THEN 'Mei'
        WHEN TO_CHAR(K.TARIKH_BICARA,'mm')='06' THEN 'Jun'
        WHEN TO_CHAR(K.TARIKH_BICARA,'mm')='07' THEN 'Julai'
        WHEN TO_CHAR(K.TARIKH_BICARA,'mm')='08' THEN 'Ogos'
        WHEN TO_CHAR(K.TARIKH_BICARA,'mm')='09' THEN 'September'
        WHEN TO_CHAR(K.TARIKH_BICARA,'mm')='10' THEN 'Oktober'
        WHEN TO_CHAR(K.TARIKH_BICARA,'mm')='11' THEN 'November'
        WHEN TO_CHAR(K.TARIKH_BICARA,'mm')='12' THEN 'Disember'
       END AS BULAN_BICARA,
       TO_CHAR(K.TARIKH_BICARA,'yyyy') AS TAHUN_BICARA,
      CASE
        WHEN E.ID_BUKTIMATI = 1 THEN ', No. Sijil Mati: '|| REPLACE(E.NO_SIJIL_MATI,'&','&#38;')
        WHEN E.ID_BUKTIMATI = 2 THEN ', Surat Sumpah Kematian: '|| REPLACE(E.NO_SIJIL_MATI,'&','&#38;')
        WHEN E.ID_BUKTIMATI = 3 THEN ', Anggapan Kematian dari Mahkamah Tinggi: '|| REPLACE(E.NO_SIJIL_MATI,'&','&#38;')
        WHEN E.ID_BUKTIMATI = 4 THEN ', No. Permit Kubur: '|| REPLACE(E.NO_SIJIL_MATI,'&','&#38;')
    ELSE ''
       END AS BUKTI_MATI,
       (SELECT REPLACE(TO_CHAR(JUMLAH_BAYARAN,'999,999,999.99'),' ') FROM TBLPPKBAYARAN WHERE ID_PERMOHONAN = A.ID_PERMOHONAN AND ID_JENISBAYARAN = 26) AS CUKAI_PUSAKA,
         HIS.NO_PINDAAN, TO_CHAR(HIS.TARIKH_KEMASKINI,'DD/MM/YYYY') AS TARIKH_PINDAAN

  FROM TBLPPKPERMOHONAN A,
       TBLPFDFAIL B,
       TBLRUJDAERAH C,
       TBLRUJNEGERI D,
       TBLPPKSIMATI E,
       TBLPPKPERMOHONANSIMATI F,
       TBLRUJNEGERI G,
       TBLPPKPEMOHON H,
       TBLRUJBANDAR I,
       TBLRUJNEGERI J,
       TBLPPKPERBICARAAN K,
       TBLPPKKEPUTUSANPERMOHONAN L,
       TBLPPKPERINTAHHTAOBDTL M,
       TBLPPKPERINTAHHTAOBMST N,
       TBLPPKOB O,
       TBLRUJNEGERI P,
       TBLRUJBANDAR Q,
       TBLRUJNEGERI R,
       TBLPPKPERINTAH S,
       TBLRUJBANDAR T ,
        (SELECT ID_FAIL, NO_PINDAAN, TARIKH_KEMASKINI FROM (
        SELECT H.ID_FAIL, H.NO_PINDAAN, H.TARIKH_KEMASKINI FROM TBLPPKBORANG_HISTORY H
        WHERE H.ID_FAIL = $P!{idfail}
        ORDER BY H.TARIKH_KEMASKINI DESC) WHERE ROWNUM = 1)HIS

 WHERE ((B.ID_FAIL = A.ID_FAIL)
        AND (D.ID_NEGERI = C.ID_NEGERI(+))
        AND (A.ID_NEGERIMHN = D.ID_NEGERI(+))
        AND (A.ID_DAERAHMHN = C.ID_DAERAH)
        AND (A.ID_PERMOHONAN = F.ID_PERMOHONAN)
        AND (F.ID_SIMATI = E.ID_SIMATI)
        AND (E.ID_NEGERI = G.ID_NEGERI(+))
        AND (H.ID_PEMOHON = A.ID_PEMOHON)
        AND (H.ID_BANDARSURAT = I.ID_BANDAR(+))
        AND (H.ID_NEGERISURAT = J.ID_NEGERI(+))
        AND (L.ID_KEPUTUSANPERMOHONAN = K.ID_KEPUTUSANPERMOHONAN)
        AND (A.ID_PERMOHONAN = L.ID_PERMOHONAN)
        AND (N.ID_JENISPERINTAH = 1)
        AND (N.ID_PERINTAHHTAOBMST = M.ID_PERINTAHHTAOBMST)
        AND (M.ID_OB = O.ID_OB(+))
        AND (M.STATUS_TADBIR = 'Y')
        AND (O.ID_BANDARSURAT = Q.ID_BANDAR(+))
        AND (O.ID_NEGERISURAT = P.ID_NEGERI(+))
        AND (K.ID_NEGERIBICARA = R.ID_NEGERI(+))
        AND (T.ID_BANDAR(+) = E.ID_BANDAR)
        AND (K.ID_PERBICARAAN = S.ID_PERBICARAAN)
        AND (N.ID_PERINTAH = S.ID_PERINTAH)
        AND (B.ID_FAIL=  $P!{idfail})
        AND (S.FLAG_JENIS_KEPUTUSAN = 0)
         and a.ID_FAIL = HIS.ID_FAIL(+)
       -- AND (K.BIL_BICARA IN (SELECT MAX(BIL_BICARA) AS BIL_BICARA FROM TBLPPKPERBICARAAN WHERE ID_KEPUTUSANPERMOHONAN = L.ID_KEPUTUSANPERMOHONAN))
       )

UNION

SELECT B.ID_FAIL,F.ID_PERMOHONAN,K.ID_PERBICARAAN,K.ID_KEPUTUSANPERMOHONAN,N.ID_PERINTAH, N.ID_HTA, N.ID_JENISPERINTAH, REPLACE(B.NO_FAIL,'&','&#38;') AS NO_FAIL, REPLACE(C.NAMA_DAERAH,'&','&#38;') AS DAERAH_MOHON, D.NAMA_NEGERI AS NEGERI_MOHON,
       TO_CHAR(A.TARIKH_MOHON,'yyyy') AS TAHUN, E.NAMA_SIMATI,E.NAMA_LAIN,
        E.NO_KP_BARU AS NBARU_MATI, E.NO_KP_LAMA AS NLAMA_MATI, E.NO_KP_LAIN AS NLAIN_MATI, H.NO_KP_BARU AS NBARU_MOHON, H.NO_KP_LAMA AS NLAMA_MOHON, H.NO_KP_LAIN AS NLAIN_MOHON,
          CASE
        WHEN E.ALAMAT_1 IS NULL AND E.ID_NEGERI <> 14 THEN '-'
        WHEN E.ALAMAT_1 IS NOT NULL AND E.ID_NEGERI <> 14 THEN Upper(REPLACE(e.ALAMAT_1,'&','&#38;')) || ', ' || Upper(REPLACE(e.ALAMAT_2,'&','&#38;')) || ', ' || Upper(REPLACE(e.ALAMAT_3,'&','&#38;'))||', ' ||REPLACE(e.poskod,'&','&#38;') || ' ' || REPLACE(REPLACE(UPPER(T.KETERANGAN),','),'&','&#38;') ||', '|| REPLACE(REPLACE(UPPER(G.NAMA_NEGERI),','),'&','&#38;')
        WHEN E.ALAMAT_2 IS NULL AND E.ALAMAT_3 IS NULL AND E.ID_NEGERI <> 14 THEN  REPLACE(UPPER(E.ALAMAT_1),',') || ', ' || REPLACE(REPLACE(UPPER(E.POSKOD),','),'&','&#38;') || ' ' || REPLACE(REPLACE(UPPER(T.KETERANGAN),','),'&','&#38;') ||', '|| REPLACE(REPLACE(UPPER(G.NAMA_NEGERI),','),'&','&#38;')
        WHEN E.ALAMAT_2 IS NULL AND E.ID_NEGERI <> 14 THEN REPLACE(UPPER(E.ALAMAT_1),',') ||', ' || REPLACE(REPLACE(UPPER(E.ALAMAT_3),','),'&','&#38;') || ', ' || REPLACE(REPLACE(UPPER(E.POSKOD),','),'&','&#38;') || ' ' ||REPLACE(REPLACE(UPPER(T.KETERANGAN),','),'&','&#38;') ||', '|| REPLACE(REPLACE(UPPER(G.NAMA_NEGERI),','),'&','&#38;')
        WHEN E.ALAMAT_3 IS NULL AND E.ID_NEGERI <> 14 THEN REPLACE(UPPER(E.ALAMAT_1),',') ||', ' || REPLACE(REPLACE(UPPER(E.ALAMAT_2),','),'&','&#38;') || ', ' || REPLACE(REPLACE(UPPER(E.POSKOD),','),'&','&#38;') || ' ' ||REPLACE(REPLACE(UPPER(T.KETERANGAN),','),'&','&#38;') ||', '|| REPLACE(REPLACE(UPPER(G.NAMA_NEGERI),','),'&','&#38;')
        WHEN E.ALAMAT_3 IS NOT NULL AND E.ID_NEGERI <> 14 THEN REPLACE(UPPER(E.ALAMAT_1),',')||', ' || REPLACE(REPLACE(UPPER(E.ALAMAT_2),','),'&','&#38;') || ', ' || REPLACE(REPLACE(UPPER(E.ALAMAT_3),','),'&','&#38;') || ', ' || REPLACE(REPLACE(UPPER(E.POSKOD),','),'&','&#38;') || ' ' ||REPLACE(REPLACE(UPPER(T.KETERANGAN),','),'&','&#38;') ||', '|| REPLACE(REPLACE(UPPER(G.NAMA_NEGERI),','),'&','&#38;')

        WHEN E.ALAMAT_1 IS NULL AND E.ID_NEGERI = 14 THEN '-'
        WHEN E.ALAMAT_1 IS NOT NULL AND E.ID_NEGERI = 14 THEN Upper(REPLACE(e.ALAMAT_1,'&','&#38;')) || ', ' || Upper(REPLACE(e.ALAMAT_2,'&','&#38;')) || ', ' || Upper(REPLACE(e.ALAMAT_3,'&','&#38;'))||', ' ||REPLACE(e.poskod,'&','&#38;') || ' ' || REPLACE(REPLACE(UPPER(T.KETERANGAN),','),'&','&#38;')
        WHEN E.ALAMAT_2 IS NULL AND E.ALAMAT_3 IS NULL AND D.ID_NEGERI = 14 THEN  REPLACE(UPPER(E.ALAMAT_1),',') || ', ' || REPLACE(REPLACE(UPPER(E.POSKOD),','),'&','&#38;') || ' ' || REPLACE(REPLACE(UPPER(T.KETERANGAN),','),'&','&#38;')
        WHEN E.ALAMAT_2 IS NULL AND E.ID_NEGERI = 14 THEN REPLACE(UPPER(E.ALAMAT_1),',') ||', ' || REPLACE(REPLACE(UPPER(E.ALAMAT_3),','),'&','&#38;') || ', ' || REPLACE(REPLACE(UPPER(E.POSKOD),','),'&','&#38;') || ' ' ||REPLACE(REPLACE(UPPER(T.KETERANGAN),','),'&','&#38;')
        WHEN E.ALAMAT_3 IS NULL AND E.ID_NEGERI = 14 THEN REPLACE(UPPER(E.ALAMAT_1),',') ||', ' || REPLACE(REPLACE(UPPER(E.ALAMAT_2),','),'&','&#38;') || ', ' || REPLACE(REPLACE(UPPER(E.POSKOD),','),'&','&#38;') || ' ' ||REPLACE(REPLACE(UPPER(T.KETERANGAN),','),'&','&#38;')
        WHEN E.ALAMAT_3 IS NOT NULL AND E.ID_NEGERI = 14 THEN REPLACE(UPPER(E.ALAMAT_1),',')||', ' || REPLACE(REPLACE(UPPER(E.ALAMAT_2),','),'&','&#38;') || ', ' || REPLACE(REPLACE(UPPER(E.ALAMAT_3),','),'&','&#38;') || ', ' || REPLACE(REPLACE(UPPER(E.POSKOD),','),'&','&#38;') || ' ' ||REPLACE(REPLACE(UPPER(T.KETERANGAN),','),'&','&#38;')

        ELSE '-'
       END AS ALAMAT_PENUH_SIMATI,
       TO_CHAR(E.TARIKH_MATI,'dd/mm/yyyy') AS TARIKH_MATI,
       REPLACE(E.NO_SIJIL_MATI,'&','&#38;') NO_SIJIL_MATI,
       H.NAMA_PEMOHON,H.NO_KP_BARU,
         CASE
        WHEN H.ALAMAT1_SURAT IS NULL THEN '-'
        WHEN H.ALAMAT2_SURAT IS NULL AND H.ALAMAT3_SURAT IS NULL THEN  REPLACE(REPLACE(UPPER(H.ALAMAT1_SURAT),','),'&','&#38;') || ', ' || REPLACE(REPLACE(UPPER(H.POSKOD_SURAT),','),'&','&#38;') ||' '||REPLACE(REPLACE(UPPER(I.KETERANGAN),','),'&','&#38;')|| ', ' || REPLACE(REPLACE(UPPER(J.NAMA_NEGERI),','),'&','&#38;')
        WHEN H.ALAMAT2_SURAT IS NULL THEN REPLACE(REPLACE(UPPER(H.ALAMAT1_SURAT),','),'&','&#38;') ||', ' || REPLACE(REPLACE(UPPER(H.ALAMAT3_SURAT),','),'&','&#38;') || REPLACE(REPLACE(UPPER(H.POSKOD_SURAT),','),'&','&#38;')||' '||REPLACE(REPLACE(UPPER(I.KETERANGAN),','),'&','&#38;') ||', '|| REPLACE(REPLACE(UPPER(J.NAMA_NEGERI),','),'&','&#38;')
        WHEN H.ALAMAT3_SURAT IS NULL THEN REPLACE(REPLACE(UPPER(H.ALAMAT1_SURAT),','),'&','&#38;') ||', ' || REPLACE(REPLACE(UPPER(H.ALAMAT2_SURAT),','),'&','&#38;') || ', ' || REPLACE(REPLACE(UPPER(H.POSKOD_SURAT),','),'&','&#38;')||' '||REPLACE(REPLACE(UPPER(I.KETERANGAN),','),'&','&#38;') ||', '|| REPLACE(REPLACE(UPPER(J.NAMA_NEGERI),','),'&','&#38;')
        WHEN H.ALAMAT3_SURAT IS NOT NULL THEN REPLACE(REPLACE(UPPER(H.ALAMAT1_SURAT),','),'&','&#38;')||', ' || REPLACE(REPLACE(UPPER(H.ALAMAT2_SURAT),','),'&','&#38;') || ', ' || REPLACE(REPLACE(UPPER(H.ALAMAT3_SURAT),','),'&','&#38;') || ', ' || REPLACE(REPLACE(UPPER(H.POSKOD_SURAT),','),'&','&#38;')||' '||REPLACE(REPLACE(UPPER(I.KETERANGAN),','),'&','&#38;') ||', '|| REPLACE(REPLACE(UPPER(J.NAMA_NEGERI),','),'&','&#38;')
        ELSE '-'
       END AS ALAMAT_PENUH_PEMOHON,

        TO_CHAR (S.TARIKH_PERINTAH,'dd/mm/yyyy') AS TARIKH_PERINTAH,
       TO_CHAR (S.TARIKH_PERINTAH,'dd') AS HARI_PERINTAH,
       CASE
        WHEN TO_CHAR(S.TARIKH_PERINTAH,'mm')='01' THEN 'Januari'
        WHEN TO_CHAR(S.TARIKH_PERINTAH,'mm')='02' THEN 'Februari'
        WHEN TO_CHAR(S.TARIKH_PERINTAH,'mm')='03' THEN 'Mac'
        WHEN TO_CHAR(S.TARIKH_PERINTAH,'mm')='04' THEN 'April'
        WHEN TO_CHAR(S.TARIKH_PERINTAH,'mm')='05' THEN 'Mei'
        WHEN TO_CHAR(S.TARIKH_PERINTAH,'mm')='06' THEN 'Jun'
        WHEN TO_CHAR(S.TARIKH_PERINTAH,'mm')='07' THEN 'Julai'
        WHEN TO_CHAR(S.TARIKH_PERINTAH,'mm')='08' THEN 'Ogos'
        WHEN TO_CHAR(S.TARIKH_PERINTAH,'mm')='09' THEN 'September'
        WHEN TO_CHAR(S.TARIKH_PERINTAH,'mm')='10' THEN 'Oktober'
        WHEN TO_CHAR(S.TARIKH_PERINTAH,'mm')='11' THEN 'November'
        WHEN TO_CHAR(S.TARIKH_PERINTAH,'mm')='12' THEN 'Disember'
      END AS BULAN_PERINTAH,
       TO_CHAR(S.TARIKH_PERINTAH,'yyyy') AS TAHUN_PERINTAH,

       CASE
                WHEN K.ALAMAT_BICARA1 IS NULL AND K.ID_NEGERIBICARA <> 14 THEN REPLACE(REPLACE(UPPER(trim(K.TEMPAT_BICARA)),','),'&','&#38;')
                WHEN K.ALAMAT_BICARA2 IS NULL AND K.ALAMAT_BICARA3 IS NULL AND K.ID_NEGERIBICARA <> 14 THEN REPLACE(REPLACE(UPPER(trim(K.TEMPAT_BICARA)),','),'&','&#38;') || ', ' || REPLACE(REPLACE(UPPER(trim(K.ALAMAT_BICARA1)),','),'&','&#38;') || ', ' || REPLACE(REPLACE(UPPER(trim(K.POSKOD)),','),'&','&#38;') || ' ' || REPLACE(REPLACE(UPPER(trim(K.BANDAR)),','),'&','&#38;') ||', '|| REPLACE(REPLACE(UPPER(trim(R.NAMA_NEGERI)),','),'&','&#38;')
                WHEN K.ALAMAT_BICARA2 IS NULL AND K.ID_NEGERIBICARA <> 14 THEN REPLACE(REPLACE(UPPER(trim(K.TEMPAT_BICARA)),','),'&','&#38;') || ', ' || REPLACE(REPLACE(UPPER(trim(K.ALAMAT_BICARA1)),','),'&','&#38;') ||', ' || REPLACE(REPLACE(UPPER(trim(K.ALAMAT_BICARA3)),','),'&','&#38;') || ', ' || REPLACE(REPLACE(UPPER(trim(K.POSKOD)),','),'&','&#38;') || ' ' ||REPLACE(REPLACE(UPPER(trim(K.BANDAR)),','),'&','&#38;') ||', '|| REPLACE(REPLACE(UPPER(trim(R.NAMA_NEGERI)),','),'&','&#38;')
                WHEN K.ALAMAT_BICARA3 IS NULL AND K.ID_NEGERIBICARA <> 14 THEN REPLACE(REPLACE(UPPER(trim(K.TEMPAT_BICARA)),','),'&','&#38;') || ', ' || REPLACE(REPLACE(UPPER(trim(K.ALAMAT_BICARA1)),','),'&','&#38;') ||', ' || REPLACE(REPLACE(UPPER(trim(K.ALAMAT_BICARA2)),','),'&','&#38;') || ', ' || REPLACE(REPLACE(UPPER(trim(K.POSKOD)),','),'&','&#38;') || ' ' ||REPLACE(REPLACE(UPPER(trim(K.BANDAR)),','),'&','&#38;') ||', '|| REPLACE(REPLACE(UPPER(trim(R.NAMA_NEGERI)),','),'&','&#38;')
                WHEN K.ALAMAT_BICARA3 IS NOT NULL AND K.ID_NEGERIBICARA <> 14 THEN REPLACE(REPLACE(UPPER(trim(K.TEMPAT_BICARA)),','),'&','&#38;') || ', ' || REPLACE(REPLACE(UPPER(trim(K.ALAMAT_BICARA1)),','),'&','&#38;')||', ' || REPLACE(REPLACE(UPPER(trim(K.ALAMAT_BICARA2)),','),'&','&#38;') || ', ' || REPLACE(REPLACE(UPPER(trim(K.ALAMAT_BICARA3)),','),'&','&#38;') || ', ' || REPLACE(REPLACE(UPPER(trim(K.POSKOD)),','),'&','&#38;') || ' ' || REPLACE(REPLACE(UPPER(trim(K.BANDAR)),','),'&','&#38;') ||', '|| REPLACE(REPLACE(UPPER(trim(R.NAMA_NEGERI)),','),'&','&#38;')

                WHEN K.ALAMAT_BICARA1 IS NULL AND K.ID_NEGERIBICARA = 14 THEN REPLACE(REPLACE(UPPER(trim(K.TEMPAT_BICARA)),','),'&','&#38;')
                WHEN K.ALAMAT_BICARA2 IS NULL AND K.ALAMAT_BICARA3 IS NULL AND K.ID_NEGERIBICARA = 14 THEN REPLACE(REPLACE(UPPER(trim(K.TEMPAT_BICARA)),','),'&','&#38;') || ', ' || REPLACE(REPLACE(UPPER(trim(K.ALAMAT_BICARA1)),','),'&','&#38;') || ', ' || REPLACE(REPLACE(UPPER(trim(K.POSKOD)),','),'&','&#38;') || ' ' || REPLACE(REPLACE(UPPER(trim(K.BANDAR)),','),'&','&#38;')
                WHEN K.ALAMAT_BICARA2 IS NULL AND K.ID_NEGERIBICARA = 14 THEN REPLACE(REPLACE(UPPER(trim(K.TEMPAT_BICARA)),','),'&','&#38;') || ', ' || REPLACE(REPLACE(UPPER(trim(K.ALAMAT_BICARA1)),','),'&','&#38;') ||', ' || REPLACE(REPLACE(UPPER(trim(K.ALAMAT_BICARA3)),','),'&','&#38;') || ', ' || REPLACE(REPLACE(UPPER(trim(K.POSKOD)),','),'&','&#38;') || ' ' ||REPLACE(REPLACE(UPPER(trim(K.BANDAR)),','),'&','&#38;')
                WHEN K.ALAMAT_BICARA3 IS NULL AND K.ID_NEGERIBICARA = 14 THEN REPLACE(REPLACE(UPPER(trim(K.TEMPAT_BICARA)),','),'&','&#38;') || ', ' || REPLACE(REPLACE(UPPER(trim(K.ALAMAT_BICARA1)),','),'&','&#38;') ||', ' || REPLACE(REPLACE(UPPER(trim(K.ALAMAT_BICARA2)),','),'&','&#38;') || ', ' || REPLACE(REPLACE(UPPER(trim(K.POSKOD)),','),'&','&#38;') || ' ' ||REPLACE(REPLACE(UPPER(trim(K.BANDAR)),','),'&','&#38;')
                WHEN K.ALAMAT_BICARA3 IS NOT NULL AND K.ID_NEGERIBICARA = 14 THEN REPLACE(REPLACE(UPPER(trim(K.TEMPAT_BICARA)),','),'&','&#38;') || ', ' || REPLACE(REPLACE(UPPER(trim(K.ALAMAT_BICARA1)),','),'&','&#38;')||', ' || REPLACE(REPLACE(UPPER(trim(K.ALAMAT_BICARA2)),','),'&','&#38;') || ', ' || REPLACE(REPLACE(UPPER(trim(K.ALAMAT_BICARA3)),','),'&','&#38;') || ', ' || REPLACE(REPLACE(UPPER(trim(K.POSKOD)),','),'&','&#38;')|| ' ' || REPLACE(REPLACE(UPPER(trim(K.BANDAR)),','),'&','&#38;')

                ELSE 'TIADA'
            END AS ALAMAT_PENUH_BICARA,
       TO_CHAR (K.TARIKH_BICARA,'dd/mm/yyyy') AS TARIKH_BICARA,
       TO_CHAR (K.TARIKH_BICARA,'dd') AS HARI_BICARA,
       CASE
        WHEN TO_CHAR(K.TARIKH_BICARA,'mm')='01' THEN 'Januari'
        WHEN TO_CHAR(K.TARIKH_BICARA,'mm')='02' THEN 'Februari'
        WHEN TO_CHAR(K.TARIKH_BICARA,'mm')='03' THEN 'Mac'
        WHEN TO_CHAR(K.TARIKH_BICARA,'mm')='04' THEN 'April'
        WHEN TO_CHAR(K.TARIKH_BICARA,'mm')='05' THEN 'Mei'
        WHEN TO_CHAR(K.TARIKH_BICARA,'mm')='06' THEN 'Jun'
        WHEN TO_CHAR(K.TARIKH_BICARA,'mm')='07' THEN 'Julai'
        WHEN TO_CHAR(K.TARIKH_BICARA,'mm')='08' THEN 'Ogos'
        WHEN TO_CHAR(K.TARIKH_BICARA,'mm')='09' THEN 'September'
        WHEN TO_CHAR(K.TARIKH_BICARA,'mm')='10' THEN 'Oktober'
        WHEN TO_CHAR(K.TARIKH_BICARA,'mm')='11' THEN 'November'
        WHEN TO_CHAR(K.TARIKH_BICARA,'mm')='12' THEN 'Disember'
       END AS BULAN_BICARA,
       TO_CHAR(K.TARIKH_BICARA,'yyyy') AS TAHUN_BICARA,
      CASE
        WHEN E.ID_BUKTIMATI = 1 THEN ', No. Sijil Mati: '|| REPLACE(E.NO_SIJIL_MATI,'&','&#38;')
        WHEN E.ID_BUKTIMATI = 2 THEN ', Surat Sumpah Kematian: '|| REPLACE(E.NO_SIJIL_MATI,'&','&#38;')
        WHEN E.ID_BUKTIMATI = 3 THEN ', Anggapan Kematian dari Mahkamah Tinggi: '|| REPLACE(E.NO_SIJIL_MATI,'&','&#38;')
        WHEN E.ID_BUKTIMATI = 4 THEN ', No. Permit Kubur: '|| REPLACE(E.NO_SIJIL_MATI,'&','&#38;')
    ELSE ''
       END AS BUKTI_MATI,
       (SELECT REPLACE(TO_CHAR(JUMLAH_BAYARAN,'999,999,999.99'),' ') FROM TBLPPKBAYARAN WHERE ID_PERMOHONAN = A.ID_PERMOHONAN AND ID_JENISBAYARAN = 26) AS CUKAI_PUSAKA,
         HIS.NO_PINDAAN, TO_CHAR(HIS.TARIKH_KEMASKINI,'DD/MM/YYYY') AS TARIKH_PINDAAN

  FROM TBLPPKPERMOHONAN A,
       TBLPFDFAIL B,
       TBLRUJDAERAH C,
       TBLRUJNEGERI D,
       TBLPPKSIMATI E,
       TBLPPKPERMOHONANSIMATI F,
       TBLRUJNEGERI G,
       TBLPPKPEMOHON H,
       TBLRUJBANDAR I,
       TBLRUJNEGERI J,
       TBLPPKPERBICARAAN K,
       TBLPPKKEPUTUSANPERMOHONAN L,
       TBLPPKPERINTAHHTAOBDTL M,
       TBLPPKPERINTAHHTAOBMST N,
       TBLPPKOB O,
       TBLRUJNEGERI P,
       TBLRUJBANDAR Q,
       TBLRUJNEGERI R,
       TBLPPKPERINTAH S,
       TBLRUJBANDAR T,
        (SELECT ID_FAIL, NO_PINDAAN, TARIKH_KEMASKINI FROM (
       SELECT H.ID_FAIL, H.NO_PINDAAN, H.TARIKH_KEMASKINI FROM TBLPPKBORANG_HISTORY H
       WHERE H.ID_FAIL = $P!{idfail}
        ORDER BY H.TARIKH_KEMASKINI DESC) WHERE ROWNUM = 1)  HIS
 WHERE ((B.ID_FAIL = A.ID_FAIL)
        AND (D.ID_NEGERI = C.ID_NEGERI(+))
        AND (A.ID_NEGERIMHN = D.ID_NEGERI(+))
        AND (A.ID_DAERAHMHN = C.ID_DAERAH)
        AND (A.ID_PERMOHONAN = F.ID_PERMOHONAN)
        AND (F.ID_SIMATI = E.ID_SIMATI)
        AND (E.ID_NEGERI = G.ID_NEGERI(+))
        --AND (E.ID_SIMATI = AAA.ID_SIMATI)
        --AND (H.ID_PEMOHON = BBB.ID_PEMOHON)
        AND (H.ID_PEMOHON = A.ID_PEMOHON)
        AND (H.ID_BANDARSURAT = I.ID_BANDAR(+))
        AND (H.ID_NEGERISURAT = J.ID_NEGERI(+))
        AND (L.ID_KEPUTUSANPERMOHONAN = K.ID_KEPUTUSANPERMOHONAN)
        AND (A.ID_PERMOHONAN = L.ID_PERMOHONAN)
        AND (N.ID_JENISPERINTAH = 2)
        AND (N.ID_PERINTAHHTAOBMST = M.ID_PERINTAHHTAOBMST)
        AND (M.ID_OB = O.ID_OB(+))
        AND (O.ID_BANDARSURAT = Q.ID_BANDAR(+))
        AND (O.ID_NEGERISURAT = P.ID_NEGERI(+))
        AND (K.ID_NEGERIBICARA = R.ID_NEGERI(+))
        AND (T.ID_BANDAR(+) = E.ID_BANDAR)
        AND (K.ID_PERBICARAAN = S.ID_PERBICARAAN)
        AND (N.ID_PERINTAH = S.ID_PERINTAH)
         and (a.ID_FAIL = HIS.ID_FAIL(+))
        AND (B.ID_FAIL=  $P!{idfail})
        AND (S.FLAG_JENIS_KEPUTUSAN = 0)
       -- AND (K.BIL_BICARA IN (SELECT MAX(BIL_BICARA) AS BIL_BICARA FROM TBLPPKPERBICARAAN WHERE ID_KEPUTUSANPERMOHONAN = L.ID_KEPUTUSANPERMOHONAN))
       )


UNION

SELECT B.ID_FAIL,F.ID_PERMOHONAN,K.ID_PERBICARAAN,K.ID_KEPUTUSANPERMOHONAN,N.ID_PERINTAH, N.ID_HA, N.ID_JENISPERINTAH, REPLACE(B.NO_FAIL,'&','&#38;') AS NO_FAIL, REPLACE(C.NAMA_DAERAH,'&','&#38;') AS DAERAH_MOHON, D.NAMA_NEGERI AS NEGERI_MOHON,
       TO_CHAR(A.TARIKH_MOHON,'yyyy') AS TAHUN, E.NAMA_SIMATI,E.NAMA_LAIN,
        E.NO_KP_BARU AS NBARU_MATI, E.NO_KP_LAMA AS NLAMA_MATI, E.NO_KP_LAIN AS NLAIN_MATI, H.NO_KP_BARU AS NBARU_MOHON, H.NO_KP_LAMA AS NLAMA_MOHON, H.NO_KP_LAIN AS NLAIN_MOHON,
          CASE
        WHEN E.ALAMAT_1 IS NULL AND E.ID_NEGERI <> 14 THEN '-'
        WHEN E.ALAMAT_1 IS NOT NULL AND E.ID_NEGERI <> 14 THEN Upper(REPLACE(e.ALAMAT_1,'&','&#38;')) || ', ' || Upper(REPLACE(e.ALAMAT_2,'&','&#38;')) || ', ' || Upper(REPLACE(e.ALAMAT_3,'&','&#38;'))||', ' ||REPLACE(e.poskod,'&','&#38;') || ' ' || REPLACE(REPLACE(UPPER(T.KETERANGAN),','),'&','&#38;') ||', '|| REPLACE(REPLACE(UPPER(G.NAMA_NEGERI),','),'&','&#38;')
        WHEN E.ALAMAT_2 IS NULL AND E.ALAMAT_3 IS NULL AND E.ID_NEGERI <> 14 THEN  REPLACE(UPPER(E.ALAMAT_1),',') || ', ' || REPLACE(REPLACE(UPPER(E.POSKOD),','),'&','&#38;') || ' ' || REPLACE(REPLACE(UPPER(T.KETERANGAN),','),'&','&#38;') ||', '|| REPLACE(REPLACE(UPPER(G.NAMA_NEGERI),','),'&','&#38;')
        WHEN E.ALAMAT_2 IS NULL AND E.ID_NEGERI <> 14 THEN REPLACE(UPPER(E.ALAMAT_1),',') ||', ' || REPLACE(REPLACE(UPPER(E.ALAMAT_3),','),'&','&#38;') || ', ' || REPLACE(REPLACE(UPPER(E.POSKOD),','),'&','&#38;') || ' ' ||REPLACE(REPLACE(UPPER(T.KETERANGAN),','),'&','&#38;') ||', '|| REPLACE(REPLACE(UPPER(G.NAMA_NEGERI),','),'&','&#38;')
        WHEN E.ALAMAT_3 IS NULL AND E.ID_NEGERI <> 14 THEN REPLACE(UPPER(E.ALAMAT_1),',') ||', ' || REPLACE(REPLACE(UPPER(E.ALAMAT_2),','),'&','&#38;') || ', ' || REPLACE(REPLACE(UPPER(E.POSKOD),','),'&','&#38;') || ' ' ||REPLACE(REPLACE(UPPER(T.KETERANGAN),','),'&','&#38;') ||', '|| REPLACE(REPLACE(UPPER(G.NAMA_NEGERI),','),'&','&#38;')
        WHEN E.ALAMAT_3 IS NOT NULL AND E.ID_NEGERI <> 14 THEN REPLACE(UPPER(E.ALAMAT_1),',')||', ' || REPLACE(REPLACE(UPPER(E.ALAMAT_2),','),'&','&#38;') || ', ' || REPLACE(REPLACE(UPPER(E.ALAMAT_3),','),'&','&#38;') || ', ' || REPLACE(REPLACE(UPPER(E.POSKOD),','),'&','&#38;') || ' ' ||REPLACE(REPLACE(UPPER(T.KETERANGAN),','),'&','&#38;') ||', '|| REPLACE(REPLACE(UPPER(G.NAMA_NEGERI),','),'&','&#38;')

        WHEN E.ALAMAT_1 IS NULL AND E.ID_NEGERI = 14 THEN '-'
        WHEN E.ALAMAT_1 IS NOT NULL AND E.ID_NEGERI = 14 THEN Upper(REPLACE(e.ALAMAT_1,'&','&#38;')) || ', ' || Upper(REPLACE(e.ALAMAT_2,'&','&#38;')) || ', ' || Upper(REPLACE(e.ALAMAT_3,'&','&#38;'))||', ' ||REPLACE(e.poskod,'&','&#38;') || ' ' || REPLACE(REPLACE(UPPER(T.KETERANGAN),','),'&','&#38;')
        WHEN E.ALAMAT_2 IS NULL AND E.ALAMAT_3 IS NULL AND D.ID_NEGERI = 14 THEN  REPLACE(UPPER(E.ALAMAT_1),',') || ', ' || REPLACE(REPLACE(UPPER(E.POSKOD),','),'&','&#38;') || ' ' || REPLACE(REPLACE(UPPER(T.KETERANGAN),','),'&','&#38;')
        WHEN E.ALAMAT_2 IS NULL AND E.ID_NEGERI = 14 THEN REPLACE(UPPER(E.ALAMAT_1),',') ||', ' || REPLACE(REPLACE(UPPER(E.ALAMAT_3),','),'&','&#38;') || ', ' || REPLACE(REPLACE(UPPER(E.POSKOD),','),'&','&#38;') || ' ' ||REPLACE(REPLACE(UPPER(T.KETERANGAN),','),'&','&#38;')
        WHEN E.ALAMAT_3 IS NULL AND E.ID_NEGERI = 14 THEN REPLACE(UPPER(E.ALAMAT_1),',') ||', ' || REPLACE(REPLACE(UPPER(E.ALAMAT_2),','),'&','&#38;') || ', ' || REPLACE(REPLACE(UPPER(E.POSKOD),','),'&','&#38;') || ' ' ||REPLACE(REPLACE(UPPER(T.KETERANGAN),','),'&','&#38;')
        WHEN E.ALAMAT_3 IS NOT NULL AND E.ID_NEGERI = 14 THEN REPLACE(UPPER(E.ALAMAT_1),',')||', ' || REPLACE(REPLACE(UPPER(E.ALAMAT_2),','),'&','&#38;') || ', ' || REPLACE(REPLACE(UPPER(E.ALAMAT_3),','),'&','&#38;') || ', ' || REPLACE(REPLACE(UPPER(E.POSKOD),','),'&','&#38;') || ' ' ||REPLACE(REPLACE(UPPER(T.KETERANGAN),','),'&','&#38;')

        ELSE '-'
       END AS ALAMAT_PENUH_SIMATI,
       TO_CHAR(E.TARIKH_MATI,'dd/mm/yyyy') AS TARIKH_MATI,
       REPLACE(E.NO_SIJIL_MATI,'&','&#38;') NO_SIJIL_MATI,
       H.NAMA_PEMOHON,H.NO_KP_BARU,
        CASE
        WHEN H.ALAMAT1_SURAT IS NULL THEN '-'
        WHEN H.ALAMAT2_SURAT IS NULL AND H.ALAMAT3_SURAT IS NULL THEN  REPLACE(REPLACE(UPPER(H.ALAMAT1_SURAT),','),'&','&#38;') || ', ' || REPLACE(REPLACE(UPPER(H.POSKOD_SURAT),','),'&','&#38;') ||' '||REPLACE(REPLACE(UPPER(I.KETERANGAN),','),'&','&#38;')|| ', ' || REPLACE(REPLACE(UPPER(J.NAMA_NEGERI),','),'&','&#38;')
        WHEN H.ALAMAT2_SURAT IS NULL THEN REPLACE(REPLACE(UPPER(H.ALAMAT1_SURAT),','),'&','&#38;') ||', ' || REPLACE(REPLACE(UPPER(H.ALAMAT3_SURAT),','),'&','&#38;') || REPLACE(REPLACE(UPPER(H.POSKOD_SURAT),','),'&','&#38;')||' '||REPLACE(REPLACE(UPPER(I.KETERANGAN),','),'&','&#38;') ||', '|| REPLACE(REPLACE(UPPER(J.NAMA_NEGERI),','),'&','&#38;')
        WHEN H.ALAMAT3_SURAT IS NULL THEN REPLACE(REPLACE(UPPER(H.ALAMAT1_SURAT),','),'&','&#38;') ||', ' || REPLACE(REPLACE(UPPER(H.ALAMAT2_SURAT),','),'&','&#38;') || ', ' || REPLACE(REPLACE(UPPER(H.POSKOD_SURAT),','),'&','&#38;')||' '||REPLACE(REPLACE(UPPER(I.KETERANGAN),','),'&','&#38;') ||', '|| REPLACE(REPLACE(UPPER(J.NAMA_NEGERI),','),'&','&#38;')
        WHEN H.ALAMAT3_SURAT IS NOT NULL THEN REPLACE(REPLACE(UPPER(H.ALAMAT1_SURAT),','),'&','&#38;')||', ' || REPLACE(REPLACE(UPPER(H.ALAMAT2_SURAT),','),'&','&#38;') || ', ' || REPLACE(REPLACE(UPPER(H.ALAMAT3_SURAT),','),'&','&#38;') || ', ' || REPLACE(REPLACE(UPPER(H.POSKOD_SURAT),','),'&','&#38;')||' '||REPLACE(REPLACE(UPPER(I.KETERANGAN),','),'&','&#38;') ||', '|| REPLACE(REPLACE(UPPER(J.NAMA_NEGERI),','),'&','&#38;')
        ELSE '-'
       END AS ALAMAT_PENUH_PEMOHON,
        TO_CHAR (S.TARIKH_PERINTAH,'dd/mm/yyyy') AS TARIKH_PERINTAH,
       TO_CHAR (S.TARIKH_PERINTAH,'dd') AS HARI_PERINTAH,
       CASE
        WHEN TO_CHAR(S.TARIKH_PERINTAH,'mm')='01' THEN 'Januari'
        WHEN TO_CHAR(S.TARIKH_PERINTAH,'mm')='02' THEN 'Februari'
        WHEN TO_CHAR(S.TARIKH_PERINTAH,'mm')='03' THEN 'Mac'
        WHEN TO_CHAR(S.TARIKH_PERINTAH,'mm')='04' THEN 'April'
        WHEN TO_CHAR(S.TARIKH_PERINTAH,'mm')='05' THEN 'Mei'
        WHEN TO_CHAR(S.TARIKH_PERINTAH,'mm')='06' THEN 'Jun'
        WHEN TO_CHAR(S.TARIKH_PERINTAH,'mm')='07' THEN 'Julai'
        WHEN TO_CHAR(S.TARIKH_PERINTAH,'mm')='08' THEN 'Ogos'
        WHEN TO_CHAR(S.TARIKH_PERINTAH,'mm')='09' THEN 'September'
        WHEN TO_CHAR(S.TARIKH_PERINTAH,'mm')='10' THEN 'Oktober'
        WHEN TO_CHAR(S.TARIKH_PERINTAH,'mm')='11' THEN 'November'
        WHEN TO_CHAR(S.TARIKH_PERINTAH,'mm')='12' THEN 'Disember'
      END AS BULAN_PERINTAH,
       TO_CHAR(S.TARIKH_PERINTAH,'yyyy') AS TAHUN_PERINTAH,

       CASE
                WHEN K.ALAMAT_BICARA1 IS NULL AND K.ID_NEGERIBICARA <> 14 THEN REPLACE(REPLACE(UPPER(trim(K.TEMPAT_BICARA)),','),'&','&#38;')
                WHEN K.ALAMAT_BICARA2 IS NULL AND K.ALAMAT_BICARA3 IS NULL AND K.ID_NEGERIBICARA <> 14 THEN REPLACE(REPLACE(UPPER(trim(K.TEMPAT_BICARA)),','),'&','&#38;') || ', ' || REPLACE(REPLACE(UPPER(trim(K.ALAMAT_BICARA1)),','),'&','&#38;') || ', ' || REPLACE(REPLACE(UPPER(trim(K.POSKOD)),','),'&','&#38;') || ' ' || REPLACE(REPLACE(UPPER(trim(K.BANDAR)),','),'&','&#38;') ||', '|| REPLACE(REPLACE(UPPER(trim(R.NAMA_NEGERI)),','),'&','&#38;')
                WHEN K.ALAMAT_BICARA2 IS NULL AND K.ID_NEGERIBICARA <> 14 THEN REPLACE(REPLACE(UPPER(trim(K.TEMPAT_BICARA)),','),'&','&#38;') || ', ' || REPLACE(REPLACE(UPPER(trim(K.ALAMAT_BICARA1)),','),'&','&#38;') ||', ' || REPLACE(REPLACE(UPPER(trim(K.ALAMAT_BICARA3)),','),'&','&#38;') || ', ' || REPLACE(REPLACE(UPPER(trim(K.POSKOD)),','),'&','&#38;') || ' ' ||REPLACE(REPLACE(UPPER(trim(K.BANDAR)),','),'&','&#38;') ||', '|| REPLACE(REPLACE(UPPER(trim(R.NAMA_NEGERI)),','),'&','&#38;')
                WHEN K.ALAMAT_BICARA3 IS NULL AND K.ID_NEGERIBICARA <> 14 THEN REPLACE(REPLACE(UPPER(trim(K.TEMPAT_BICARA)),','),'&','&#38;') || ', ' || REPLACE(REPLACE(UPPER(trim(K.ALAMAT_BICARA1)),','),'&','&#38;') ||', ' || REPLACE(REPLACE(UPPER(trim(K.ALAMAT_BICARA2)),','),'&','&#38;') || ', ' || REPLACE(REPLACE(UPPER(trim(K.POSKOD)),','),'&','&#38;') || ' ' ||REPLACE(REPLACE(UPPER(trim(K.BANDAR)),','),'&','&#38;') ||', '|| REPLACE(REPLACE(UPPER(trim(R.NAMA_NEGERI)),','),'&','&#38;')
                WHEN K.ALAMAT_BICARA3 IS NOT NULL AND K.ID_NEGERIBICARA <> 14 THEN REPLACE(REPLACE(UPPER(trim(K.TEMPAT_BICARA)),','),'&','&#38;') || ', ' || REPLACE(REPLACE(UPPER(trim(K.ALAMAT_BICARA1)),','),'&','&#38;')||', ' || REPLACE(REPLACE(UPPER(trim(K.ALAMAT_BICARA2)),','),'&','&#38;') || ', ' || REPLACE(REPLACE(UPPER(trim(K.ALAMAT_BICARA3)),','),'&','&#38;') || ', ' || REPLACE(REPLACE(UPPER(trim(K.POSKOD)),','),'&','&#38;') || ' ' || REPLACE(REPLACE(UPPER(trim(K.BANDAR)),','),'&','&#38;') ||', '|| REPLACE(REPLACE(UPPER(trim(R.NAMA_NEGERI)),','),'&','&#38;')

                WHEN K.ALAMAT_BICARA1 IS NULL AND K.ID_NEGERIBICARA = 14 THEN REPLACE(REPLACE(UPPER(trim(K.TEMPAT_BICARA)),','),'&','&#38;')
                WHEN K.ALAMAT_BICARA2 IS NULL AND K.ALAMAT_BICARA3 IS NULL AND K.ID_NEGERIBICARA = 14 THEN REPLACE(REPLACE(UPPER(trim(K.TEMPAT_BICARA)),','),'&','&#38;') || ', ' || REPLACE(REPLACE(UPPER(trim(K.ALAMAT_BICARA1)),','),'&','&#38;') || ', ' || REPLACE(REPLACE(UPPER(trim(K.POSKOD)),','),'&','&#38;') || ' ' || REPLACE(REPLACE(UPPER(trim(K.BANDAR)),','),'&','&#38;')
                WHEN K.ALAMAT_BICARA2 IS NULL AND K.ID_NEGERIBICARA = 14 THEN REPLACE(REPLACE(UPPER(trim(K.TEMPAT_BICARA)),','),'&','&#38;') || ', ' || REPLACE(REPLACE(UPPER(trim(K.ALAMAT_BICARA1)),','),'&','&#38;') ||', ' || REPLACE(REPLACE(UPPER(trim(K.ALAMAT_BICARA3)),','),'&','&#38;') || ', ' || REPLACE(REPLACE(UPPER(trim(K.POSKOD)),','),'&','&#38;') || ' ' ||REPLACE(REPLACE(UPPER(trim(K.BANDAR)),','),'&','&#38;')
                WHEN K.ALAMAT_BICARA3 IS NULL AND K.ID_NEGERIBICARA = 14 THEN REPLACE(REPLACE(UPPER(trim(K.TEMPAT_BICARA)),','),'&','&#38;') || ', ' || REPLACE(REPLACE(UPPER(trim(K.ALAMAT_BICARA1)),','),'&','&#38;') ||', ' || REPLACE(REPLACE(UPPER(trim(K.ALAMAT_BICARA2)),','),'&','&#38;') || ', ' || REPLACE(REPLACE(UPPER(trim(K.POSKOD)),','),'&','&#38;') || ' ' ||REPLACE(REPLACE(UPPER(trim(K.BANDAR)),','),'&','&#38;')
                WHEN K.ALAMAT_BICARA3 IS NOT NULL AND K.ID_NEGERIBICARA = 14 THEN REPLACE(REPLACE(UPPER(trim(K.TEMPAT_BICARA)),','),'&','&#38;') || ', ' || REPLACE(REPLACE(UPPER(trim(K.ALAMAT_BICARA1)),','),'&','&#38;')||', ' || REPLACE(REPLACE(UPPER(trim(K.ALAMAT_BICARA2)),','),'&','&#38;') || ', ' || REPLACE(REPLACE(UPPER(trim(K.ALAMAT_BICARA3)),','),'&','&#38;') || ', ' || REPLACE(REPLACE(UPPER(trim(K.POSKOD)),','),'&','&#38;')|| ' ' || REPLACE(REPLACE(UPPER(trim(K.BANDAR)),','),'&','&#38;')

                ELSE 'TIADA'
            END AS ALAMAT_PENUH_BICARA,
       TO_CHAR (K.TARIKH_BICARA,'dd/mm/yyyy') AS TARIKH_BICARA,
       TO_CHAR (K.TARIKH_BICARA,'dd') AS HARI_BICARA,
       CASE
        WHEN TO_CHAR(K.TARIKH_BICARA,'mm')='01' THEN 'Januari'
        WHEN TO_CHAR(K.TARIKH_BICARA,'mm')='02' THEN 'Februari'
        WHEN TO_CHAR(K.TARIKH_BICARA,'mm')='03' THEN 'Mac'
        WHEN TO_CHAR(K.TARIKH_BICARA,'mm')='04' THEN 'April'
        WHEN TO_CHAR(K.TARIKH_BICARA,'mm')='05' THEN 'Mei'
        WHEN TO_CHAR(K.TARIKH_BICARA,'mm')='06' THEN 'Jun'
        WHEN TO_CHAR(K.TARIKH_BICARA,'mm')='07' THEN 'Julai'
        WHEN TO_CHAR(K.TARIKH_BICARA,'mm')='08' THEN 'Ogos'
        WHEN TO_CHAR(K.TARIKH_BICARA,'mm')='09' THEN 'September'
        WHEN TO_CHAR(K.TARIKH_BICARA,'mm')='10' THEN 'Oktober'
        WHEN TO_CHAR(K.TARIKH_BICARA,'mm')='11' THEN 'November'
        WHEN TO_CHAR(K.TARIKH_BICARA,'mm')='12' THEN 'Disember'
       END AS BULAN_BICARA,
       TO_CHAR(K.TARIKH_BICARA,'yyyy') AS TAHUN_BICARA,
      CASE
        WHEN E.ID_BUKTIMATI = 1 THEN ', No. Sijil Mati: '|| REPLACE(E.NO_SIJIL_MATI,'&','&#38;')
        WHEN E.ID_BUKTIMATI = 2 THEN ', Surat Sumpah Kematian: '|| REPLACE(E.NO_SIJIL_MATI,'&','&#38;')
        WHEN E.ID_BUKTIMATI = 3 THEN ', Anggapan Kematian dari Mahkamah Tinggi: '|| REPLACE(E.NO_SIJIL_MATI,'&','&#38;')
        WHEN E.ID_BUKTIMATI = 4 THEN ', No. Permit Kubur: '|| REPLACE(E.NO_SIJIL_MATI,'&','&#38;')
    ELSE ''
       END AS BUKTI_MATI,
       (SELECT REPLACE(TO_CHAR(JUMLAH_BAYARAN,'999,999,999.99'),' ') FROM TBLPPKBAYARAN WHERE ID_PERMOHONAN = A.ID_PERMOHONAN AND ID_JENISBAYARAN = 26) AS CUKAI_PUSAKA,
        HIS.NO_PINDAAN, TO_CHAR(HIS.TARIKH_KEMASKINI,'DD/MM/YYYY') AS TARIKH_PINDAAN
  FROM TBLPPKPERMOHONAN A,
       TBLPFDFAIL B,
       TBLRUJDAERAH C,
       TBLRUJNEGERI D,
       TBLPPKSIMATI E,
       TBLPPKPERMOHONANSIMATI F,
       TBLRUJNEGERI G,
       TBLPPKPEMOHON H,
       TBLRUJBANDAR I,
       TBLRUJNEGERI J,
       TBLPPKPERBICARAAN K,
       TBLPPKKEPUTUSANPERMOHONAN L,
       TBLPPKPERINTAHHAOBDTL M,
       TBLPPKPERINTAHHAOBMST N,
       TBLPPKOB O,
       TBLRUJNEGERI P,
       TBLRUJBANDAR Q,
       TBLRUJNEGERI R,
       TBLPPKPERINTAH S,
       TBLRUJBANDAR T,
  (SELECT ID_FAIL, NO_PINDAAN, TARIKH_KEMASKINI FROM (
        SELECT H.ID_FAIL, H.NO_PINDAAN, H.TARIKH_KEMASKINI FROM TBLPPKBORANG_HISTORY H
        WHERE H.ID_FAIL = $P!{idfail}
        ORDER BY H.TARIKH_KEMASKINI DESC) WHERE ROWNUM = 1)  HIS
 WHERE ((B.ID_FAIL = A.ID_FAIL)
        AND (D.ID_NEGERI = C.ID_NEGERI(+))
        AND (A.ID_NEGERIMHN = D.ID_NEGERI(+))
        AND (A.ID_DAERAHMHN = C.ID_DAERAH)
        AND (A.ID_PERMOHONAN = F.ID_PERMOHONAN)
        AND (F.ID_SIMATI = E.ID_SIMATI)
        AND (E.ID_NEGERI = G.ID_NEGERI(+))
        AND (H.ID_PEMOHON = A.ID_PEMOHON)
        AND (H.ID_BANDARSURAT = I.ID_BANDAR(+))
        AND (H.ID_NEGERISURAT = J.ID_NEGERI(+))
        AND (L.ID_KEPUTUSANPERMOHONAN = K.ID_KEPUTUSANPERMOHONAN)
        AND (A.ID_PERMOHONAN = L.ID_PERMOHONAN)
        AND (N.ID_JENISPERINTAH = 2)
        AND (N.ID_PERINTAHHAOBMST = M.ID_PERINTAHHAOBMST)
        AND (M.ID_OB = O.ID_OB(+))
        AND (O.ID_BANDARSURAT = Q.ID_BANDAR(+))
        AND (O.ID_NEGERISURAT = P.ID_NEGERI(+))
        AND (K.ID_NEGERIBICARA = R.ID_NEGERI(+))
        AND (T.ID_BANDAR(+) = E.ID_BANDAR)
        AND (K.ID_PERBICARAAN = S.ID_PERBICARAAN)
        AND (N.ID_PERINTAH = S.ID_PERINTAH)
         and a.ID_FAIL = HIS.ID_FAIL(+)
        AND (B.ID_FAIL= $P!{idfail})
        AND (S.FLAG_JENIS_KEPUTUSAN = 0)
       -- AND (K.BIL_BICARA IN (SELECT MAX(BIL_BICARA) AS BIL_BICARA FROM TBLPPKPERBICARAAN WHERE ID_KEPUTUSANPERMOHONAN = L.ID_KEPUTUSANPERMOHONAN))
       )

  UNION

  SELECT B.ID_FAIL,F.ID_PERMOHONAN,K.ID_PERBICARAAN,K.ID_KEPUTUSANPERMOHONAN,N.ID_PERINTAH, N.ID_HA, N.ID_JENISPERINTAH, B.NO_FAIL, C.NAMA_DAERAH AS DAERAH_MOHON, D.NAMA_NEGERI AS NEGERI_MOHON,
       TO_CHAR(A.TARIKH_MOHON,'yyyy') AS TAHUN, E.NAMA_SIMATI,E.NAMA_LAIN,
        E.NO_KP_BARU AS NBARU_MATI, E.NO_KP_LAMA AS NLAMA_MATI, E.NO_KP_LAIN AS NLAIN_MATI, H.NO_KP_BARU AS NBARU_MOHON, H.NO_KP_LAMA AS NLAMA_MOHON, H.NO_KP_LAIN AS NLAIN_MOHON,
        CASE
        WHEN E.ALAMAT_1 IS NULL AND E.ID_NEGERI <> 14 THEN '-'
        WHEN E.ALAMAT_1 IS NOT NULL AND E.ID_NEGERI <> 14 THEN Upper(REPLACE(e.ALAMAT_1,'&','&#38;')) || ', ' || Upper(REPLACE(e.ALAMAT_2,'&','&#38;')) || ', ' || Upper(REPLACE(e.ALAMAT_3,'&','&#38;'))||', ' ||REPLACE(e.poskod,'&','&#38;') || ' ' || REPLACE(REPLACE(UPPER(T.KETERANGAN),','),'&','&#38;') ||', '|| REPLACE(REPLACE(UPPER(G.NAMA_NEGERI),','),'&','&#38;')
        WHEN E.ALAMAT_2 IS NULL AND E.ALAMAT_3 IS NULL AND E.ID_NEGERI <> 14 THEN  REPLACE(UPPER(E.ALAMAT_1),',') || ', ' || REPLACE(REPLACE(UPPER(E.POSKOD),','),'&','&#38;') || ' ' || REPLACE(REPLACE(UPPER(T.KETERANGAN),','),'&','&#38;') ||', '|| REPLACE(REPLACE(UPPER(G.NAMA_NEGERI),','),'&','&#38;')
        WHEN E.ALAMAT_2 IS NULL AND E.ID_NEGERI <> 14 THEN REPLACE(UPPER(E.ALAMAT_1),',') ||', ' || REPLACE(REPLACE(UPPER(E.ALAMAT_3),','),'&','&#38;') || ', ' || REPLACE(REPLACE(UPPER(E.POSKOD),','),'&','&#38;') || ' ' ||REPLACE(REPLACE(UPPER(T.KETERANGAN),','),'&','&#38;') ||', '|| REPLACE(REPLACE(UPPER(G.NAMA_NEGERI),','),'&','&#38;')
        WHEN E.ALAMAT_3 IS NULL AND E.ID_NEGERI <> 14 THEN REPLACE(UPPER(E.ALAMAT_1),',') ||', ' || REPLACE(REPLACE(UPPER(E.ALAMAT_2),','),'&','&#38;') || ', ' || REPLACE(REPLACE(UPPER(E.POSKOD),','),'&','&#38;') || ' ' ||REPLACE(REPLACE(UPPER(T.KETERANGAN),','),'&','&#38;') ||', '|| REPLACE(REPLACE(UPPER(G.NAMA_NEGERI),','),'&','&#38;')
        WHEN E.ALAMAT_3 IS NOT NULL AND E.ID_NEGERI <> 14 THEN REPLACE(UPPER(E.ALAMAT_1),',')||', ' || REPLACE(REPLACE(UPPER(E.ALAMAT_2),','),'&','&#38;') || ', ' || REPLACE(REPLACE(UPPER(E.ALAMAT_3),','),'&','&#38;') || ', ' || REPLACE(REPLACE(UPPER(E.POSKOD),','),'&','&#38;') || ' ' ||REPLACE(REPLACE(UPPER(T.KETERANGAN),','),'&','&#38;') ||', '|| REPLACE(REPLACE(UPPER(G.NAMA_NEGERI),','),'&','&#38;')

        WHEN E.ALAMAT_1 IS NULL AND E.ID_NEGERI = 14 THEN '-'
        WHEN E.ALAMAT_1 IS NOT NULL AND E.ID_NEGERI = 14 THEN Upper(REPLACE(e.ALAMAT_1,'&','&#38;')) || ', ' || Upper(REPLACE(e.ALAMAT_2,'&','&#38;')) || ', ' || Upper(REPLACE(e.ALAMAT_3,'&','&#38;'))||', ' ||REPLACE(e.poskod,'&','&#38;') || ' ' || REPLACE(REPLACE(UPPER(T.KETERANGAN),','),'&','&#38;')
        WHEN E.ALAMAT_2 IS NULL AND E.ALAMAT_3 IS NULL AND D.ID_NEGERI = 14 THEN  REPLACE(UPPER(E.ALAMAT_1),',') || ', ' || REPLACE(REPLACE(UPPER(E.POSKOD),','),'&','&#38;') || ' ' || REPLACE(REPLACE(UPPER(T.KETERANGAN),','),'&','&#38;')
        WHEN E.ALAMAT_2 IS NULL AND E.ID_NEGERI = 14 THEN REPLACE(UPPER(E.ALAMAT_1),',') ||', ' || REPLACE(REPLACE(UPPER(E.ALAMAT_3),','),'&','&#38;') || ', ' || REPLACE(REPLACE(UPPER(E.POSKOD),','),'&','&#38;') || ' ' ||REPLACE(REPLACE(UPPER(T.KETERANGAN),','),'&','&#38;')
        WHEN E.ALAMAT_3 IS NULL AND E.ID_NEGERI = 14 THEN REPLACE(UPPER(E.ALAMAT_1),',') ||', ' || REPLACE(REPLACE(UPPER(E.ALAMAT_2),','),'&','&#38;') || ', ' || REPLACE(REPLACE(UPPER(E.POSKOD),','),'&','&#38;') || ' ' ||REPLACE(REPLACE(UPPER(T.KETERANGAN),','),'&','&#38;')
        WHEN E.ALAMAT_3 IS NOT NULL AND E.ID_NEGERI = 14 THEN REPLACE(UPPER(E.ALAMAT_1),',')||', ' || REPLACE(REPLACE(UPPER(E.ALAMAT_2),','),'&','&#38;') || ', ' || REPLACE(REPLACE(UPPER(E.ALAMAT_3),','),'&','&#38;') || ', ' || REPLACE(REPLACE(UPPER(E.POSKOD),','),'&','&#38;') || ' ' ||REPLACE(REPLACE(UPPER(T.KETERANGAN),','),'&','&#38;')

        ELSE '-'
       END AS ALAMAT_PENUH_SIMATI,
       TO_CHAR(E.TARIKH_MATI,'dd/mm/yyyy') AS TARIKH_MATI,
       REPLACE(E.NO_SIJIL_MATI,'&','&#38;') NO_SIJIL_MATI,
       H.NAMA_PEMOHON,H.NO_KP_BARU,
       CASE
        WHEN H.ALAMAT1_SURAT IS NULL THEN '-'
        WHEN H.ALAMAT2_SURAT IS NULL AND H.ALAMAT3_SURAT IS NULL THEN  REPLACE(REPLACE(UPPER(H.ALAMAT1_SURAT),','),'&','&#38;') || ', ' || REPLACE(REPLACE(UPPER(H.POSKOD_SURAT),','),'&','&#38;') ||' '||REPLACE(REPLACE(UPPER(I.KETERANGAN),','),'&','&#38;')|| ', ' || REPLACE(REPLACE(UPPER(J.NAMA_NEGERI),','),'&','&#38;')
        WHEN H.ALAMAT2_SURAT IS NULL THEN REPLACE(REPLACE(UPPER(H.ALAMAT1_SURAT),','),'&','&#38;') ||', ' || REPLACE(REPLACE(UPPER(H.ALAMAT3_SURAT),','),'&','&#38;') || REPLACE(REPLACE(UPPER(H.POSKOD_SURAT),','),'&','&#38;')||' '||REPLACE(REPLACE(UPPER(I.KETERANGAN),','),'&','&#38;') ||', '|| REPLACE(REPLACE(UPPER(J.NAMA_NEGERI),','),'&','&#38;')
        WHEN H.ALAMAT3_SURAT IS NULL THEN REPLACE(REPLACE(UPPER(H.ALAMAT1_SURAT),','),'&','&#38;') ||', ' || REPLACE(REPLACE(UPPER(H.ALAMAT2_SURAT),','),'&','&#38;') || ', ' || REPLACE(REPLACE(UPPER(H.POSKOD_SURAT),','),'&','&#38;')||' '||REPLACE(REPLACE(UPPER(I.KETERANGAN),','),'&','&#38;') ||', '|| REPLACE(REPLACE(UPPER(J.NAMA_NEGERI),','),'&','&#38;')
        WHEN H.ALAMAT3_SURAT IS NOT NULL THEN REPLACE(REPLACE(UPPER(H.ALAMAT1_SURAT),','),'&','&#38;')||', ' || REPLACE(REPLACE(UPPER(H.ALAMAT2_SURAT),','),'&','&#38;') || ', ' || REPLACE(REPLACE(UPPER(H.ALAMAT3_SURAT),','),'&','&#38;') || ', ' || REPLACE(REPLACE(UPPER(H.POSKOD_SURAT),','),'&','&#38;')||' '||REPLACE(REPLACE(UPPER(I.KETERANGAN),','),'&','&#38;') ||', '|| REPLACE(REPLACE(UPPER(J.NAMA_NEGERI),','),'&','&#38;')
        ELSE '-'
       END AS ALAMAT_PENUH_PEMOHON,
        TO_CHAR (S.TARIKH_PERINTAH,'dd/mm/yyyy') AS TARIKH_PERINTAH,
       TO_CHAR (S.TARIKH_PERINTAH,'dd') AS HARI_PERINTAH,
       CASE
        WHEN TO_CHAR(S.TARIKH_PERINTAH,'mm')='01' THEN 'Januari'
        WHEN TO_CHAR(S.TARIKH_PERINTAH,'mm')='02' THEN 'Februari'
        WHEN TO_CHAR(S.TARIKH_PERINTAH,'mm')='03' THEN 'Mac'
        WHEN TO_CHAR(S.TARIKH_PERINTAH,'mm')='04' THEN 'April'
        WHEN TO_CHAR(S.TARIKH_PERINTAH,'mm')='05' THEN 'Mei'
        WHEN TO_CHAR(S.TARIKH_PERINTAH,'mm')='06' THEN 'Jun'
        WHEN TO_CHAR(S.TARIKH_PERINTAH,'mm')='07' THEN 'Julai'
        WHEN TO_CHAR(S.TARIKH_PERINTAH,'mm')='08' THEN 'Ogos'
        WHEN TO_CHAR(S.TARIKH_PERINTAH,'mm')='09' THEN 'September'
        WHEN TO_CHAR(S.TARIKH_PERINTAH,'mm')='10' THEN 'Oktober'
        WHEN TO_CHAR(S.TARIKH_PERINTAH,'mm')='11' THEN 'November'
        WHEN TO_CHAR(S.TARIKH_PERINTAH,'mm')='12' THEN 'Disember'
      END AS BULAN_PERINTAH,
       TO_CHAR(S.TARIKH_PERINTAH,'yyyy') AS TAHUN_PERINTAH,

       CASE
                WHEN K.ALAMAT_BICARA1 IS NULL AND K.ID_NEGERIBICARA <> 14 THEN REPLACE(REPLACE(UPPER(trim(K.TEMPAT_BICARA)),','),'&','&#38;')
                WHEN K.ALAMAT_BICARA2 IS NULL AND K.ALAMAT_BICARA3 IS NULL AND K.ID_NEGERIBICARA <> 14 THEN REPLACE(REPLACE(UPPER(trim(K.TEMPAT_BICARA)),','),'&','&#38;') || ', ' || REPLACE(REPLACE(UPPER(trim(K.ALAMAT_BICARA1)),','),'&','&#38;') || ', ' || REPLACE(REPLACE(UPPER(trim(K.POSKOD)),','),'&','&#38;') || ' ' || REPLACE(REPLACE(UPPER(trim(K.BANDAR)),','),'&','&#38;') ||', '|| REPLACE(REPLACE(UPPER(trim(R.NAMA_NEGERI)),','),'&','&#38;')
                WHEN K.ALAMAT_BICARA2 IS NULL AND K.ID_NEGERIBICARA <> 14 THEN REPLACE(REPLACE(UPPER(trim(K.TEMPAT_BICARA)),','),'&','&#38;') || ', ' || REPLACE(REPLACE(UPPER(trim(K.ALAMAT_BICARA1)),','),'&','&#38;') ||', ' || REPLACE(REPLACE(UPPER(trim(K.ALAMAT_BICARA3)),','),'&','&#38;') || ', ' || REPLACE(REPLACE(UPPER(trim(K.POSKOD)),','),'&','&#38;') || ' ' ||REPLACE(REPLACE(UPPER(trim(K.BANDAR)),','),'&','&#38;') ||', '|| REPLACE(REPLACE(UPPER(trim(R.NAMA_NEGERI)),','),'&','&#38;')
                WHEN K.ALAMAT_BICARA3 IS NULL AND K.ID_NEGERIBICARA <> 14 THEN REPLACE(REPLACE(UPPER(trim(K.TEMPAT_BICARA)),','),'&','&#38;') || ', ' || REPLACE(REPLACE(UPPER(trim(K.ALAMAT_BICARA1)),','),'&','&#38;') ||', ' || REPLACE(REPLACE(UPPER(trim(K.ALAMAT_BICARA2)),','),'&','&#38;') || ', ' || REPLACE(REPLACE(UPPER(trim(K.POSKOD)),','),'&','&#38;') || ' ' ||REPLACE(REPLACE(UPPER(trim(K.BANDAR)),','),'&','&#38;') ||', '|| REPLACE(REPLACE(UPPER(trim(R.NAMA_NEGERI)),','),'&','&#38;')
                WHEN K.ALAMAT_BICARA3 IS NOT NULL AND K.ID_NEGERIBICARA <> 14 THEN REPLACE(REPLACE(UPPER(trim(K.TEMPAT_BICARA)),','),'&','&#38;') || ', ' || REPLACE(REPLACE(UPPER(trim(K.ALAMAT_BICARA1)),','),'&','&#38;')||', ' || REPLACE(REPLACE(UPPER(trim(K.ALAMAT_BICARA2)),','),'&','&#38;') || ', ' || REPLACE(REPLACE(UPPER(trim(K.ALAMAT_BICARA3)),','),'&','&#38;') || ', ' || REPLACE(REPLACE(UPPER(trim(K.POSKOD)),','),'&','&#38;') || ' ' || REPLACE(REPLACE(UPPER(trim(K.BANDAR)),','),'&','&#38;') ||', '|| REPLACE(REPLACE(UPPER(trim(R.NAMA_NEGERI)),','),'&','&#38;')

                WHEN K.ALAMAT_BICARA1 IS NULL AND K.ID_NEGERIBICARA = 14 THEN REPLACE(REPLACE(UPPER(trim(K.TEMPAT_BICARA)),','),'&','&#38;')
                WHEN K.ALAMAT_BICARA2 IS NULL AND K.ALAMAT_BICARA3 IS NULL AND K.ID_NEGERIBICARA = 14 THEN REPLACE(REPLACE(UPPER(trim(K.TEMPAT_BICARA)),','),'&','&#38;') || ', ' || REPLACE(REPLACE(UPPER(trim(K.ALAMAT_BICARA1)),','),'&','&#38;') || ', ' || REPLACE(REPLACE(UPPER(trim(K.POSKOD)),','),'&','&#38;') || ' ' || REPLACE(REPLACE(UPPER(trim(K.BANDAR)),','),'&','&#38;')
                WHEN K.ALAMAT_BICARA2 IS NULL AND K.ID_NEGERIBICARA = 14 THEN REPLACE(REPLACE(UPPER(trim(K.TEMPAT_BICARA)),','),'&','&#38;') || ', ' || REPLACE(REPLACE(UPPER(trim(K.ALAMAT_BICARA1)),','),'&','&#38;') ||', ' || REPLACE(REPLACE(UPPER(trim(K.ALAMAT_BICARA3)),','),'&','&#38;') || ', ' || REPLACE(REPLACE(UPPER(trim(K.POSKOD)),','),'&','&#38;') || ' ' ||REPLACE(REPLACE(UPPER(trim(K.BANDAR)),','),'&','&#38;')
                WHEN K.ALAMAT_BICARA3 IS NULL AND K.ID_NEGERIBICARA = 14 THEN REPLACE(REPLACE(UPPER(trim(K.TEMPAT_BICARA)),','),'&','&#38;') || ', ' || REPLACE(REPLACE(UPPER(trim(K.ALAMAT_BICARA1)),','),'&','&#38;') ||', ' || REPLACE(REPLACE(UPPER(trim(K.ALAMAT_BICARA2)),','),'&','&#38;') || ', ' || REPLACE(REPLACE(UPPER(trim(K.POSKOD)),','),'&','&#38;') || ' ' ||REPLACE(REPLACE(UPPER(trim(K.BANDAR)),','),'&','&#38;')
                WHEN K.ALAMAT_BICARA3 IS NOT NULL AND K.ID_NEGERIBICARA = 14 THEN REPLACE(REPLACE(UPPER(trim(K.TEMPAT_BICARA)),','),'&','&#38;') || ', ' || REPLACE(REPLACE(UPPER(trim(K.ALAMAT_BICARA1)),','),'&','&#38;')||', ' || REPLACE(REPLACE(UPPER(trim(K.ALAMAT_BICARA2)),','),'&','&#38;') || ', ' || REPLACE(REPLACE(UPPER(trim(K.ALAMAT_BICARA3)),','),'&','&#38;') || ', ' || REPLACE(REPLACE(UPPER(trim(K.POSKOD)),','),'&','&#38;')|| ' ' || REPLACE(REPLACE(UPPER(trim(K.BANDAR)),','),'&','&#38;')

                ELSE 'TIADA'
            END AS ALAMAT_PENUH_BICARA,
       TO_CHAR (K.TARIKH_BICARA,'dd/mm/yyyy') AS TARIKH_BICARA,
       TO_CHAR (K.TARIKH_BICARA,'dd') AS HARI_BICARA,
       CASE
        WHEN TO_CHAR(K.TARIKH_BICARA,'mm')='01' THEN 'Januari'
        WHEN TO_CHAR(K.TARIKH_BICARA,'mm')='02' THEN 'Februari'
        WHEN TO_CHAR(K.TARIKH_BICARA,'mm')='03' THEN 'Mac'
        WHEN TO_CHAR(K.TARIKH_BICARA,'mm')='04' THEN 'April'
        WHEN TO_CHAR(K.TARIKH_BICARA,'mm')='05' THEN 'Mei'
        WHEN TO_CHAR(K.TARIKH_BICARA,'mm')='06' THEN 'Jun'
        WHEN TO_CHAR(K.TARIKH_BICARA,'mm')='07' THEN 'Julai'
        WHEN TO_CHAR(K.TARIKH_BICARA,'mm')='08' THEN 'Ogos'
        WHEN TO_CHAR(K.TARIKH_BICARA,'mm')='09' THEN 'September'
        WHEN TO_CHAR(K.TARIKH_BICARA,'mm')='10' THEN 'Oktober'
        WHEN TO_CHAR(K.TARIKH_BICARA,'mm')='11' THEN 'November'
        WHEN TO_CHAR(K.TARIKH_BICARA,'mm')='12' THEN 'Disember'
       END AS BULAN_BICARA,
       TO_CHAR(K.TARIKH_BICARA,'yyyy') AS TAHUN_BICARA,
      CASE
        WHEN E.ID_BUKTIMATI = 1 THEN ', No. Sijil Mati: '|| REPLACE(E.NO_SIJIL_MATI,'&','&#38;')
        WHEN E.ID_BUKTIMATI = 2 THEN ', Surat Sumpah Kematian: '|| REPLACE(E.NO_SIJIL_MATI,'&','&#38;')
        WHEN E.ID_BUKTIMATI = 3 THEN ', Anggapan Kematian dari Mahkamah Tinggi: '|| REPLACE(E.NO_SIJIL_MATI,'&','&#38;')
        WHEN E.ID_BUKTIMATI = 4 THEN ', No. Permit Kubur: '|| REPLACE(E.NO_SIJIL_MATI,'&','&#38;')
    ELSE ''
       END AS BUKTI_MATI,
       (SELECT REPLACE(TO_CHAR(JUMLAH_BAYARAN,'999,999,999.99'),' ') FROM TBLPPKBAYARAN WHERE ID_PERMOHONAN = A.ID_PERMOHONAN AND ID_JENISBAYARAN = 26) AS CUKAI_PUSAKA,
         HIS.NO_PINDAAN, TO_CHAR(HIS.TARIKH_KEMASKINI,'DD/MM/YYYY') AS TARIKH_PINDAAN
  FROM TBLPPKPERMOHONAN A,
       TBLPFDFAIL B,
       TBLRUJDAERAH C,
       TBLRUJNEGERI D,
       TBLPPKSIMATI E,
       TBLPPKPERMOHONANSIMATI F,
       TBLRUJNEGERI G,
       TBLPPKPEMOHON H,
       TBLRUJBANDAR I,
       TBLRUJNEGERI J,
       TBLPPKPERBICARAAN K,
       TBLPPKKEPUTUSANPERMOHONAN L,
       TBLPPKPERINTAHHAOBDTL M,
       TBLPPKPERINTAHHAOBMST N,
       TBLPPKOB O,
       TBLRUJNEGERI P,
       TBLRUJBANDAR Q,
       TBLRUJNEGERI R,
       TBLPPKPERINTAH S,
       TBLRUJBANDAR T,
  (SELECT ID_FAIL, NO_PINDAAN, TARIKH_KEMASKINI FROM (
        SELECT H.ID_FAIL, H.NO_PINDAAN, H.TARIKH_KEMASKINI FROM TBLPPKBORANG_HISTORY H
        WHERE H.ID_FAIL = $P!{idfail}
        ORDER BY H.TARIKH_KEMASKINI DESC) WHERE ROWNUM = 1)  HIS
 WHERE ((B.ID_FAIL = A.ID_FAIL)
        AND (D.ID_NEGERI = C.ID_NEGERI(+))
        AND (A.ID_NEGERIMHN = D.ID_NEGERI(+))
        AND (A.ID_DAERAHMHN = C.ID_DAERAH)
        AND (A.ID_PERMOHONAN = F.ID_PERMOHONAN)
        AND (F.ID_SIMATI = E.ID_SIMATI)
        AND (E.ID_NEGERI = G.ID_NEGERI(+))
       -- AND (E.ID_SIMATI = AAA.ID_SIMATI)
       -- AND (H.ID_PEMOHON = BBB.ID_PEMOHON)
        AND (H.ID_PEMOHON = A.ID_PEMOHON)
        AND (H.ID_BANDARSURAT = I.ID_BANDAR(+))
        AND (H.ID_NEGERISURAT = J.ID_NEGERI(+))
        AND (L.ID_KEPUTUSANPERMOHONAN = K.ID_KEPUTUSANPERMOHONAN)
        AND (A.ID_PERMOHONAN = L.ID_PERMOHONAN)
        AND (N.ID_JENISPERINTAH = 1)
        AND (M.STATUS_TADBIR = 'Y')
        AND (N.ID_PERINTAHHAOBMST = M.ID_PERINTAHHAOBMST)
        AND (M.ID_OB = O.ID_OB(+))
        AND (O.ID_BANDARSURAT = Q.ID_BANDAR(+))
        AND (O.ID_NEGERISURAT = P.ID_NEGERI(+))
        AND (K.ID_NEGERIBICARA = R.ID_NEGERI(+))
        AND (T.ID_BANDAR(+) = E.ID_BANDAR)
        AND (K.ID_PERBICARAAN = S.ID_PERBICARAAN)
        AND (N.ID_PERINTAH = S.ID_PERINTAH)
         and a.ID_FAIL = HIS.ID_FAIL(+)
        AND (B.ID_FAIL= $P!{idfail})
        AND (S.FLAG_JENIS_KEPUTUSAN = 0)
       -- AND (K.BIL_BICARA IN (SELECT MAX(BIL_BICARA) AS BIL_BICARA FROM TBLPPKPERBICARAAN WHERE ID_KEPUTUSANPERMOHONAN = L.ID_KEPUTUSANPERMOHONAN))
       )
       ) UTAMA
where ROWNUM = 1]]>
	</queryString>
	<field name="ID_FAIL" class="java.lang.String"/>
	<field name="ID_PERMOHONAN" class="java.lang.String"/>
	<field name="ID_PERBICARAAN" class="java.lang.String"/>
	<field name="ID_KEPUTUSANPERMOHONAN" class="java.lang.String"/>
	<field name="ID_PERINTAH" class="java.lang.Number"/>
	<field name="ID_HTA" class="java.lang.Number"/>
	<field name="ID_JENISPERINTAH" class="java.lang.String"/>
	<field name="NO_FAIL" class="java.lang.String"/>
	<field name="DAERAH_MOHON" class="java.lang.String"/>
	<field name="NEGERI_MOHON" class="java.lang.String"/>
	<field name="TAHUN" class="java.lang.String"/>
	<field name="NAMA_SIMATI" class="java.lang.String"/>
	<field name="NAMA_LAIN" class="java.lang.String"/>
	<field name="NBARU_MATI" class="java.lang.String"/>
	<field name="NLAMA_MATI" class="java.lang.String"/>
	<field name="NLAIN_MATI" class="java.lang.String"/>
	<field name="NBARU_MOHON" class="java.lang.String"/>
	<field name="NLAMA_MOHON" class="java.lang.String"/>
	<field name="NLAIN_MOHON" class="java.lang.String"/>
	<field name="ALAMAT_PENUH_SIMATI" class="java.lang.String"/>
	<field name="TARIKH_MATI" class="java.lang.String"/>
	<field name="NO_SIJIL_MATI" class="java.lang.String"/>
	<field name="NAMA_PEMOHON" class="java.lang.String"/>
	<field name="NO_KP_BARU" class="java.lang.String"/>
	<field name="ALAMAT_PENUH_PEMOHON" class="java.lang.String"/>
	<field name="TARIKH_PERINTAH" class="java.lang.String"/>
	<field name="HARI_PERINTAH" class="java.lang.String"/>
	<field name="BULAN_PERINTAH" class="java.lang.String"/>
	<field name="TAHUN_PERINTAH" class="java.lang.String"/>
	<field name="ALAMAT_PENUH_BICARA" class="java.lang.String"/>
	<field name="TARIKH_BICARA" class="java.lang.String"/>
	<field name="HARI_BICARA" class="java.lang.String"/>
	<field name="BULAN_BICARA" class="java.lang.String"/>
	<field name="TAHUN_BICARA" class="java.lang.String"/>
	<field name="BUKTI_MATI" class="java.lang.String"/>
	<field name="CUKAI_PUSAKA" class="java.lang.String"/>
	<field name="NO_PINDAAN" class="java.lang.String"/>
	<field name="TARIKH_PINDAAN" class="java.lang.String"/>
	<field name="KP_SIMATI" class="java.lang.String"/>
	<field name="KP_PEMOHON" class="java.lang.String"/>
	<background>
		<band splitType="Stretch"/>
	</background>
	<title>
		<band splitType="Stretch"/>
	</title>
	<pageHeader>
		<band splitType="Prevent"/>
	</pageHeader>
	<columnHeader>
		<band splitType="Stretch"/>
	</columnHeader>
	<detail>
		<band height="114" splitType="Stretch">
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement uuid="c0ea13a2-dc6b-4a4f-8271-50c12faf91e0" key="textField-13" positionType="Float" x="42" y="0" width="450" height="19"/>
				<textElement textAlignment="Center" verticalAlignment="Middle" markup="styled">
					<font fontName="Verdana" size="9" isBold="false" pdfFontName="Helvetica"/>
				</textElement>
				<textFieldExpression><![CDATA["<style isBold='true' pdfFontName='Helvetica-Bold'>"+"BORANG F"+"</style>"
+"\n(Peraturan 7(2))"
+"\n<style isBold='true' pdfFontName='Helvetica-Bold'>"+"MALAYSIA"+"</style>"
+"\n\nNegeri <style isBold='true' pdfFontName='Helvetica-Bold'>"+($F{NEGERI_MOHON}!= null ? $F{NEGERI_MOHON}:"TIADA")+"</style>"
+"\nDaerah <style isBold='true' pdfFontName='Helvetica-Bold'>"+($F{DAERAH_MOHON}!= null ? $F{DAERAH_MOHON}:"TIADA")+"</style>"
+"\n\n<style isBold='true' pdfFontName='Helvetica-Bold'>"+"AKTA HARTA PUSAKA KECIL (PEMBAHAGIAN), 1955"+"</style>"
+"\nGUAMAN PEMBAHAGIAN NO. <style isBold='true' pdfFontName='Helvetica-Bold'>"+($F{NO_FAIL}!= null ? $F{NO_FAIL}:"TIADA")+"</style> TAHUN <style isBold='true' pdfFontName='Helvetica-Bold'>"+($F{TAHUN}!= null ? $F{TAHUN}:"TIADA")+"</style>"
+"\n"]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" pattern="dd/MM/yyyy" isBlankWhenNull="false">
				<reportElement uuid="e292304a-3773-4a8e-83d8-524e430b8f91" key="textField-2" positionType="Float" x="42" y="20" width="450" height="23"/>
				<textElement textAlignment="Justified" markup="styled">
					<font fontName="Verdana" size="9"/>
				</textElement>
				<textFieldExpression><![CDATA["Dalam hal Harta pusaka  <style isBold='true' pdfFontName='Helvetica-Bold'>" + ($F{NAMA_LAIN}!= null ? $F{NAMA_SIMATI}+" @ "+$F{NAMA_LAIN}:$F{NAMA_SIMATI}) +  ", No. KP: "  + ($F{KP_SIMATI} != null ? $F{KP_SIMATI}:"TIADA") +  ", Tarikh Mati: "+ ($F{TARIKH_MATI} != null ? $F{TARIKH_MATI}:"TIADA")+($F{BUKTI_MATI}!=null?$F{BUKTI_MATI}:"")+".</style>"
+"\n\nPetisyen daripada  <style isBold='true' pdfFontName='Helvetica-Bold'>" + ($F{NAMA_PEMOHON}!= null ? $F{NAMA_PEMOHON}:"TIADA")+($F{NO_KP_BARU}!= null ?  ", No. KP: "+ $F{KP_PEMOHON}:" ")+"</style> yang beralamat di <style isBold='true' pdfFontName='Helvetica-Bold'>" +($F{ALAMAT_PENUH_PEMOHON}!= null ? $F{ALAMAT_PENUH_PEMOHON}:"-")+".</style>"
+"\n\n                                     <style isBold='true' pdfFontName='Helvetica-Bold'>PEMBERIAN SURAT KUASA MENTADBIR DI BAWAH SEKSYEN 13</style>"
+"\n\nSAYA <style isBold='true' pdfFontName='Helvetica-Bold'>"+($P{namaPegawai}!= null ? $P{namaPegawai}:"TIADA")+ " - " +($P{jawatan}!= null ? $P{jawatan}:"TIADA")+"</style> <style isBold='true' pdfFontName='Helvetica-Bold'>" +($F{DAERAH_MOHON}!= null ? $F{DAERAH_MOHON}:"TIADA")+"</style> dengan ini memaklumkan bahawa pada <style isBold='true' pdfFontName='Helvetica-Bold'>"+($F{HARI_BICARA}!= null ? $F{HARI_BICARA}:"TIADA")+"</style> haribulan <style isBold='true' pdfFontName='Helvetica-Bold'>"+($F{BULAN_BICARA}!= null ? $F{BULAN_BICARA}:"TIADA")+" "+($F{TAHUN_BICARA}!= null ? $F{TAHUN_BICARA}:"")+"</style>, Surat Kuasa Mentadbir harta pusaka dan barang kepunyaan <style isBold='true' pdfFontName='Helvetica-Bold'>"+($F{NAMA_SIMATI}!= null ?$F{NAMA_SIMATI}:"TIADA")+"</style> si mati yang dahulunya beralamat di <style isBold='true' pdfFontName='Helvetica-Bold'>" +($F{ALAMAT_PENUH_SIMATI}!= null ?$F{ALAMAT_PENUH_SIMATI}:"-")+"</style> telah diberikan kepada "
+"\n<style isBold='true' pdfFontName='Helvetica-Bold'>"+$P{namaPentadbirBorangF} + "</style> setelah dia mengaku janji untuk mentadbirkan harta pusaka dan barang itu, dan membuat suatu inventori lengkap dan benar tentang harta pusaka dan barang tersebut dan mempamerkan inventori itu kepada <style isBold='true' pdfFontName='Helvetica-Bold'>* PENTADBIR TANAH </style> bagi Daerah itu dalam tempoh enam bulan daripada tarikh pemberian ini atau dalam tempoh lanjutan sebagaimana yang <style isBold='true' pdfFontName='Helvetica-Bold'>* PENTADBIR TANAH </style> boleh ditetapkan dari semasa ke semasa dan juga memberikan kepada <style isBold='true' pdfFontName='Helvetica-Bold'>* PENTADBIR TANAH </style> suatu akaun sebenar mengenai harta pusaka dan barang tersebut dalam tempoh satu tahun daripada tarikh yang sama atau dalam tempoh lanjutan sebagaimana yang <style isBold='true' pdfFontName='Helvetica-Bold'>* PENTADBIR TANAH </style> boleh ditetapkan dari semasa ke semasa."
+"\n\n"+"**Pemberian ini adalah tertakluk kepada pengehadan yang berikut :-"
+"\n\n"+"                   Ia adalah terhad di bawah seksyen 13  Akta Harta Pusaka Kecil (Pembahagian) 1955, kepada pemungutan dan pemeliharaan harta simati dan memberi pelepasan bagi hutang harta pusakanya yang kena dibayar, tertakluk kepada arahan <style isBold='true' pdfFontName='Helvetica-Bold'>* PENTADBIR TANAH.</style>"
+"\n\n"+"Suatu jadual harta si mati adalah seperti dilampirkan di mukasurat sebelah."
+"\n\n"+"Diberikan di bawah tandatangan dan meterai saya di <style isBold='true' pdfFontName='Helvetica-Bold'>"+($F{ALAMAT_PENUH_BICARA}!= null ? $F{ALAMAT_PENUH_BICARA}:"TIADA")+".</style> "
+"\n"+"Pada <style isBold='true' pdfFontName='Helvetica-Bold'>"+($F{HARI_PERINTAH}!= null ? $F{HARI_PERINTAH}:"TIADA")+"</style> haribulan <style isBold='true' pdfFontName='Helvetica-Bold'>"+($F{BULAN_PERINTAH}!= null ? $F{BULAN_PERINTAH}:"TIADA")+" "+($F{TAHUN_PERINTAH}!= null ? $F{TAHUN_PERINTAH}:"")+".</style>"]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement uuid="0f886518-f064-47b8-bf47-560091337828" key="staticText-13" positionType="Float" x="333" y="66" width="97" height="11"/>
				<textElement textAlignment="Left" verticalAlignment="Middle">
					<font fontName="Verdana" size="9" isBold="false" isItalic="false" isUnderline="false" pdfFontName="Helvetica"/>
				</textElement>
				<text><![CDATA[PENTADBIR TANAH /]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="8b5a6f07-61e6-41a2-b9e8-6953c9e9a6aa" key="staticText-14" positionType="Float" x="333" y="78" width="167" height="11"/>
				<textElement textAlignment="Left" verticalAlignment="Middle">
					<font fontName="Verdana" size="9" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="true" pdfFontName="Helvetica"/>
				</textElement>
				<text><![CDATA[PEGAWAI DAERAH/ PEGAWAI]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="55ead870-35ff-47c1-93ba-09ca1d82f949" key="staticText-15" positionType="Float" x="333" y="90" width="194" height="11"/>
				<textElement textAlignment="Left" verticalAlignment="Middle">
					<font fontName="Verdana" size="9" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="true" pdfFontName="Helvetica"/>
				</textElement>
				<text><![CDATA[TADBIR SARAWAK]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="d713b7bb-a895-4021-a519-5e5e189a7076" key="staticText-16" positionType="Float" x="299" y="52" width="229" height="12"/>
				<textElement/>
				<text><![CDATA[T.M      ...................................................

]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="6cfeed05-90e4-4820-a60a-4021b4ea3e58" key="staticText-17" positionType="Float" x="428" y="66" width="54" height="11"/>
				<textElement textAlignment="Left" verticalAlignment="Middle">
					<font fontName="Verdana" size="9" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="true" pdfFontName="Helvetica"/>
				</textElement>
				<text><![CDATA[PEMUNGUT]]></text>
			</staticText>
		</band>
		<band height="20" splitType="Prevent">
			<line>
				<reportElement uuid="21ea5d05-e2e6-4f2b-88cc-2ceb7830f267" key="line-1" positionType="Float" x="32" y="2" width="450" height="1">
					<printWhenExpression><![CDATA[new Boolean($V{PAGE_NUMBER}.intValue()==1)]]></printWhenExpression>
				</reportElement>
			</line>
			<textField isBlankWhenNull="false">
				<reportElement uuid="efac87ca-d75c-4289-9ff6-d1f707fb3a79" key="textField-8" positionType="Float" x="32" y="3" width="460" height="17"/>
				<textElement>
					<font fontName="Verdana" size="6"/>
				</textElement>
				<textFieldExpression><![CDATA["*    Masukkan Pentadbir Tanah Daerah / Pemungut / Pegawai Daerah / Pegawai Pentadbir Sarawak, mengikut kehendak keadaan."+"\n"+"**  Hendaklah dipotong jika perintah itu adalah untuk pentadbiran yang dihadkan di bawah Seksyen 13 (4) Akta itu."]]></textFieldExpression>
			</textField>
		</band>
		<band height="87" splitType="Stretch">
			<subreport isUsingCache="true">
				<reportElement uuid="a48d022b-bb9c-4fbd-a2b7-30472d1b6dcb" key="subreport-3" positionType="Float" x="42" y="57" width="450" height="14"/>
				<subreportParameter name="TAHUN_PERINTAH">
					<subreportParameterExpression><![CDATA[$F{TAHUN_PERINTAH}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="ReportDir">
					<subreportParameterExpression><![CDATA[$P{ReportDir}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="idfail">
					<subreportParameterExpression><![CDATA[$P{idfail}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="namaPegawai">
					<subreportParameterExpression><![CDATA[$P{namaPegawai}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="jawatan">
					<subreportParameterExpression><![CDATA[$P{jawatan}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="daerahMohon">
					<subreportParameterExpression><![CDATA[$P{daerahMohon}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="idPermohonan">
					<subreportParameterExpression><![CDATA[""+$F{ID_PERMOHONAN}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="namaPentadbir">
					<subreportParameterExpression><![CDATA[$P{namaPentadbir}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="HARI_PERINTAH">
					<subreportParameterExpression><![CDATA[$F{HARI_PERINTAH}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="BULAN_PERINTAH">
					<subreportParameterExpression><![CDATA[$F{BULAN_PERINTAH}]]></subreportParameterExpression>
				</subreportParameter>
				<connectionExpression><![CDATA[$P{REPORT_CONNECTION}]]></connectionExpression>
				<subreportExpression><![CDATA[$P{ReportDir} + "//ppk//BorangF2_subreportRekodPendaftaran.jasper"]]></subreportExpression>
			</subreport>
			<break>
				<reportElement uuid="6325def4-fd7b-4c69-a305-b755ebc47fd0" key="element-367" x="0" y="2" width="535" height="1"/>
			</break>
			<subreport isUsingCache="true">
				<reportElement uuid="30a20d3b-d94e-4166-b09f-516582bda195" key="subreport-1" positionType="Float" x="42" y="22" width="450" height="14"/>
				<subreportParameter name="idfail">
					<subreportParameterExpression><![CDATA[$P{idfail}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="ReportDir">
					<subreportParameterExpression><![CDATA[$P{ReportDir}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="namaPegawai">
					<subreportParameterExpression><![CDATA[$P{namaPegawai}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="jawatan">
					<subreportParameterExpression><![CDATA[$P{jawatan}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="daerahMohon">
					<subreportParameterExpression><![CDATA[$P{daerahMohon}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="namaPentadbir">
					<subreportParameterExpression><![CDATA[$P{namaPentadbir}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="namaPentadbirBorangF">
					<subreportParameterExpression><![CDATA[$P{namaPentadbirBorangF}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="NILAI_BERSIH_1">
					<subreportParameterExpression><![CDATA[$P{NILAI_BERSIH_1}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="NILAI_BERSIH_2">
					<subreportParameterExpression><![CDATA[$P{NILAI_BERSIH_2}]]></subreportParameterExpression>
				</subreportParameter>
				<connectionExpression><![CDATA[$P{REPORT_CONNECTION}]]></connectionExpression>
				<subreportExpression><![CDATA[$P{ReportDir} + "//ppk//BorangF2_subreportJadualHarta.jasper"]]></subreportExpression>
			</subreport>
			<staticText>
				<reportElement uuid="f278d10d-9355-4aff-8d8f-634f31739c82" key="staticText-12" positionType="Float" x="42" y="7" width="450" height="11"/>
				<textElement textAlignment="Center">
					<font fontName="Verdana" size="9" isBold="true" pdfFontName="Helvetica-Bold"/>
				</textElement>
				<text><![CDATA[JADUAL HARTA SIMATI YANG DINAMAKAN DI ATAS]]></text>
			</staticText>
			<subreport isUsingCache="true">
				<reportElement uuid="045a368b-0aac-4345-b5d1-517cea7ca46d" key="subreport-4" positionType="Float" x="52" y="82" width="450" height="5" isRemoveLineWhenBlank="true">
					<printWhenExpression><![CDATA[$P{flagLampiran}]]></printWhenExpression>
				</reportElement>
				<subreportParameter name="idPerintah">
					<subreportParameterExpression><![CDATA[""+$F{ID_PERINTAH}]]></subreportParameterExpression>
				</subreportParameter>
				<connectionExpression><![CDATA[$P{REPORT_CONNECTION}]]></connectionExpression>
				<subreportExpression><![CDATA[$P{ReportDir} + "//ppk//BorangF_LampiranWaris.jasper"]]></subreportExpression>
			</subreport>
			<break>
				<reportElement uuid="960ba4d5-b3c7-4976-8c61-5059272df244" key="element-3" positionType="Float" mode="Transparent" x="0" y="73" width="535" height="1" isRemoveLineWhenBlank="true">
					<printWhenExpression><![CDATA[$P{flagLampiran}]]></printWhenExpression>
				</reportElement>
			</break>
		</band>
	</detail>
	<columnFooter>
		<band splitType="Stretch"/>
	</columnFooter>
	<pageFooter>
		<band splitType="Stretch"/>
	</pageFooter>
	<summary>
		<band splitType="Stretch"/>
	</summary>
</jasperReport>
